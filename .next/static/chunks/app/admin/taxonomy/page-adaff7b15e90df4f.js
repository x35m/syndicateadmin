(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[16],{8363:function(e,t,s){Promise.resolve().then(s.bind(s,1310))},1310:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return A}});var r=s(7437),a=s(2265),n=s(6219),i=s(495),l=s(4693),c=s(6013),o=s(6466),d=s(837),u=s(6910),m=s(3102),f=s(7135),x=s(2738),h=s(6975),p=s(5273),j=s(3146),g=s(7776),y=s(7934);let b=(0,y.Z)("Settings2",[["path",{d:"M20 7h-9",key:"3s1dr2"}],["path",{d:"M14 17H5",key:"gfn3mx"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]]);var v=s(5388);let N=(0,y.Z)("MoreHorizontal",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]),w=(0,y.Z)("PencilLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z",key:"ymcmye"}],["path",{d:"m15 5 3 3",key:"1w25hb"}]]);var C=s(3925);let k={categories:[],countries:[]},z={categories:{label:"Категории",type:"category"},countries:{label:"Страны",type:"country"},cities:{label:"Города",type:"city"}},R={category:"Промпт категорий",country:"Промпт стран",city:"Промпт городов"};function A(){var e,t;let[s,y]=(0,a.useState)("categories"),[A,S]=(0,a.useState)(k),[Z,T]=(0,a.useState)(!0),[V,O]=(0,a.useState)(null),[M,I]=(0,a.useState)(!1),[_,E]=(0,a.useState)(null),[D,F]=(0,a.useState)({category:"",country:"",city:""}),[P,X]=(0,a.useState)(!1),[H,Y]=(0,a.useState)(!1),[L,W]=(0,a.useState)({categories:"",countries:"",cities:""}),[U,$]=(0,a.useState)({categories:new Set,countries:new Set,cities:new Set}),[K,B]=(0,a.useState)(()=>new Set),J=(0,a.useMemo)(()=>A.countries.flatMap(e=>e.cities.map(t=>({...t,countryName:e.name}))),[A.countries]),q=async()=>{try{var e,t;T(!0);let s=await fetch("/api/taxonomy"),r=await s.json();if(!r.success){g.Am.error(r.error||"Не удалось получить данные таксономии");return}S({categories:null!==(e=r.categories)&&void 0!==e?e:[],countries:null!==(t=r.countries)&&void 0!==t?t:[]})}catch(e){console.error("Error fetching taxonomy:",e),g.Am.error("Не удалось получить данные таксономии")}finally{T(!1)}},Q=async()=>{try{X(!0);let e=await fetch("/api/taxonomy/prompts"),t=await e.json();t.success&&t.data&&F(t.data)}catch(e){console.error("Error fetching taxonomy prompts:",e),g.Am.error("Не удалось загрузить системные промпты")}finally{X(!1)}},G=async(e,t)=>{B(t=>{let s=new Set(t);return s.add(e),s});try{let s=await fetch("/api/taxonomy",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:"category",id:e,isHidden:t})}),r=await s.json();if(!s.ok||!r.success){g.Am.error(r.error||"Не удалось обновить категорию");return}await q(),g.Am.success(t?"Категория скрыта из публичного раздела":"Категория снова видна в публичном разделе")}catch(e){console.error("Error toggling category visibility:",e),g.Am.error("Не удалось изменить видимость категории")}finally{B(t=>{let s=new Set(t);return s.delete(e),s})}};(0,a.useEffect)(()=>{q(),Q()},[]);let ee=(e,t)=>{$(s=>{let r=new Set(s[e]);return r.has(t)?r.delete(t):r.add(t),{...s,[e]:r}})},et=(e,t)=>{$(s=>{let r=new Set(s[e]);return t.every(e=>r.has(e))?t.forEach(e=>r.delete(e)):t.forEach(e=>r.add(e)),{...s,[e]:r}})},es=e=>{$(t=>({...t,[e]:new Set}))},er=e=>{let t=z[e].type;O({mode:"create",type:t,name:"",countryId:"city"===t?null:void 0})},ea=(e,t,s,r)=>{let a=z[e].type;O({mode:"edit",type:a,id:t,name:s,countryId:"city"===a?null!=r?r:null:void 0})},en=async()=>{if(!V)return;let{mode:e,type:t,name:s,id:r,countryId:a}=V,n=s.trim();if(!n){g.Am.warning("Название не может быть пустым");return}if("city"===t&&!a){g.Am.warning("Выберите страну для города");return}try{if(I(!0),"create"===e){let e=await fetch("/api/taxonomy",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:t,name:n,countryId:"city"===t?a:void 0})}),s=await e.json();if(!s.success){g.Am.error(s.error||"Не удалось создать элемент");return}g.Am.success("Элемент создан")}else if(void 0!==r){let e=await fetch("/api/taxonomy",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:t,id:r,name:n,countryId:"city"===t?a:void 0})}),s=await e.json();if(!e.ok||!s.success){g.Am.error(s.error||"Не удалось обновить элемент");return}g.Am.success("Элемент обновлён")}await q(),O(null)}catch(e){console.error("Error saving taxonomy item:",e),g.Am.error("Не удалось сохранить элемент")}finally{I(!1)}},ei=async(e,t)=>{try{let s=await fetch("/api/taxonomy?type=".concat(e,"&id=").concat(t),{method:"DELETE"}),r=await s.json();if(!s.ok||!r.success)return g.Am.error(r.error||"Не удалось удалить элемент"),!1;return!0}catch(e){return console.error("Error deleting taxonomy item:",e),g.Am.error("Не удалось удалить элемент"),!1}},el=async e=>{let t=Array.from(U[e]);if(0===t.length||!window.confirm("countries"===e?"Удалить выбранные страны? Все связанные города будут удалены.":"cities"===e?"Удалить выбранные города?":"Удалить выбранные элементы?"))return;let s=z[e].type;for(let e of t)if(!await ei(s,e))break;await q(),es(e),g.Am.success("Удаление выполнено")},ec=e=>{var t;let s=z[e].type;E({type:s,value:null!==(t=D[s])&&void 0!==t?t:""})},eo=async()=>{if(!_)return;let{type:e,value:t}=_,s=t.trim();if(!s){g.Am.warning("Промпт не может быть пустым");return}try{Y(!0);let t=await fetch("/api/taxonomy/prompts",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:e,prompt:s})}),r=await t.json();if(!t.ok||!r.success){g.Am.error(r.error||"Не удалось сохранить промпт");return}F(t=>({...t,[e]:s})),g.Am.success("Промпт обновлён"),E(null)}catch(e){console.error("Error saving taxonomy prompt:",e),g.Am.error("Не удалось сохранить промпт")}finally{Y(!1)}},ed=e=>{let t=L[e].toLowerCase(),s=A[e];return t?s.filter(e=>e.name.toLowerCase().includes(t)):s},eu=(0,a.useMemo)(()=>{let e=L.countries.toLowerCase();return e?A.countries.filter(t=>t.name.toLowerCase().includes(e)):A.countries},[A.countries,L.countries]),em=(0,a.useMemo)(()=>{let e=L.cities.toLowerCase();return e?J.filter(t=>t.name.toLowerCase().includes(e)||t.countryName.toLowerCase().includes(e)):J},[J,L.cities]),ef=U[s].size;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.P,{}),(0,r.jsx)("div",{className:"min-h-screen bg-background p-8",children:(0,r.jsxs)("div",{className:"container space-y-6",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold",children:"Справочники"}),(0,r.jsx)("p",{className:"text-muted-foreground max-w-2xl",children:"Управляйте таксономиями материалов, настраивайте системные промпты для нейросети и выполняйте массовые операции над элементами."})]}),(0,r.jsxs)(p.mQ,{value:s,onValueChange:e=>y(e),children:[(0,r.jsx)(p.dr,{className:"flex-wrap",children:Object.keys(z).map(e=>(0,r.jsx)(p.SP,{value:e,children:z[e].label},e))}),(0,r.jsx)(p.nU,{value:"categories",children:(e=>{let t=ed(e),s=t.map(e=>e.id),a=U[e],n=z[e].type;return(0,r.jsxs)(c.Zb,{children:[(0,r.jsxs)(c.Ol,{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(c.ll,{children:z[e].label}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground mt-2",children:"Используйте таблицу для просмотра, редактирования и массового удаления."})]}),(0,r.jsxs)("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(m.I,{placeholder:"Поиск...",value:L[e],onChange:t=>W(s=>({...s,[e]:t.target.value})),className:"h-9 w-full sm:w-48"}),(0,r.jsxs)(i.z,{variant:"outline",size:"sm",onClick:()=>ec(e),disabled:P,children:[(0,r.jsx)(b,{className:"mr-2 h-4 w-4"}),"Системный промпт"]})]}),(0,r.jsxs)(i.z,{size:"sm",onClick:()=>er(e),children:[(0,r.jsx)(v.Z,{className:"mr-2 h-4 w-4"}),"Добавить"]})]})]}),(0,r.jsx)(c.aY,{children:Z?(0,r.jsx)("div",{className:"space-y-2",children:Array.from({length:6}).map((e,t)=>(0,r.jsx)(x.O,{className:"h-10 w-full"},t))}):0===t.length?(0,r.jsx)("div",{className:"py-10 text-center text-sm text-muted-foreground",children:"Элементы не найдены."}):(0,r.jsxs)(h.iA,{children:[(0,r.jsx)(h.xD,{children:(0,r.jsxs)(h.SC,{children:[(0,r.jsx)(h.ss,{className:"w-12",children:(0,r.jsx)(o.X,{checked:t.length>0&&s.every(e=>a.has(e)),onCheckedChange:()=>et(e,s)})}),(0,r.jsx)(h.ss,{children:"Название"}),"categories"===e&&(0,r.jsx)(h.ss,{className:"w-40 text-center",children:"Видимость"}),(0,r.jsx)(h.ss,{className:"w-16 text-right",children:"Действия"})]})}),(0,r.jsx)(h.RM,{children:t.map(t=>(0,r.jsxs)(h.SC,{children:[(0,r.jsx)(h.pj,{children:(0,r.jsx)(o.X,{checked:a.has(t.id),onCheckedChange:()=>ee(e,t.id)})}),(0,r.jsx)(h.pj,{className:"font-medium",children:t.name}),"categories"===e&&(0,r.jsx)(h.pj,{children:(0,r.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,r.jsx)(l.C,{variant:t.isHidden?"outline":"default",children:t.isHidden?"Скрыта":"Видна"}),(0,r.jsx)(i.z,{variant:"ghost",size:"sm",onClick:()=>G(t.id,!t.isHidden),disabled:K.has(t.id),children:K.has(t.id)?"Сохранение...":t.isHidden?"Показать":"Скрыть"})]})}),(0,r.jsx)(h.pj,{className:"text-right",children:(0,r.jsxs)(u.h_,{children:[(0,r.jsx)(u.$F,{asChild:!0,children:(0,r.jsx)(i.z,{variant:"ghost",size:"icon",className:"h-8 w-8",children:(0,r.jsx)(N,{className:"h-4 w-4"})})}),(0,r.jsxs)(u.AW,{align:"end",children:[(0,r.jsxs)(u.Xi,{onClick:()=>ea(e,t.id,t.name),children:[(0,r.jsx)(w,{className:"mr-2 h-4 w-4"}),"Редактировать"]}),(0,r.jsxs)(u.Xi,{onClick:async()=>{window.confirm("Удалить элемент?")&&await ei(n,t.id)&&(g.Am.success("Элемент удалён"),await q())},className:"text-destructive focus:text-destructive",children:[(0,r.jsx)(C.Z,{className:"mr-2 h-4 w-4"}),"Удалить"]})]})]})})]},t.id))})]})})]})})("categories")}),(0,r.jsx)(p.nU,{value:"countries",children:(()=>{let e="countries",t=U[e],s=eu.map(e=>e.id);return(0,r.jsxs)(c.Zb,{children:[(0,r.jsxs)(c.Ol,{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(c.ll,{children:"Страны"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground mt-2",children:"Управляйте списком стран и связанных городов."})]}),(0,r.jsxs)("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(m.I,{placeholder:"Поиск страны...",value:L.countries,onChange:e=>W(t=>({...t,countries:e.target.value})),className:"h-9 w-full sm:w-56"}),(0,r.jsxs)(i.z,{variant:"outline",size:"sm",onClick:()=>ec("countries"),disabled:P,children:[(0,r.jsx)(b,{className:"mr-2 h-4 w-4"}),"Системный промпт"]})]}),(0,r.jsxs)(i.z,{size:"sm",onClick:()=>er("countries"),children:[(0,r.jsx)(v.Z,{className:"mr-2 h-4 w-4"}),"Добавить страну"]})]})]}),(0,r.jsx)(c.aY,{children:Z?(0,r.jsx)("div",{className:"space-y-2",children:Array.from({length:6}).map((e,t)=>(0,r.jsx)(x.O,{className:"h-10 w-full"},t))}):0===eu.length?(0,r.jsx)("div",{className:"py-10 text-center text-sm text-muted-foreground",children:"Страны не найдены."}):(0,r.jsxs)(h.iA,{children:[(0,r.jsx)(h.xD,{children:(0,r.jsxs)(h.SC,{children:[(0,r.jsx)(h.ss,{className:"w-12",children:(0,r.jsx)(o.X,{checked:eu.length>0&&s.every(e=>t.has(e)),onCheckedChange:()=>et(e,s)})}),(0,r.jsx)(h.ss,{children:"Название"}),(0,r.jsx)(h.ss,{className:"w-24 text-right",children:"Городов"}),(0,r.jsx)(h.ss,{className:"w-16 text-right",children:"Действия"})]})}),(0,r.jsx)(h.RM,{children:eu.map(s=>(0,r.jsxs)(h.SC,{children:[(0,r.jsx)(h.pj,{children:(0,r.jsx)(o.X,{checked:t.has(s.id),onCheckedChange:()=>ee(e,s.id)})}),(0,r.jsx)(h.pj,{className:"font-medium",children:s.name}),(0,r.jsx)(h.pj,{className:"text-right",children:s.cities.length}),(0,r.jsx)(h.pj,{className:"text-right",children:(0,r.jsxs)(u.h_,{children:[(0,r.jsx)(u.$F,{asChild:!0,children:(0,r.jsx)(i.z,{variant:"ghost",size:"icon",className:"h-8 w-8",children:(0,r.jsx)(N,{className:"h-4 w-4"})})}),(0,r.jsxs)(u.AW,{align:"end",children:[(0,r.jsxs)(u.Xi,{onClick:()=>ea("countries",s.id,s.name),children:[(0,r.jsx)(w,{className:"mr-2 h-4 w-4"}),"Редактировать"]}),(0,r.jsxs)(u.Xi,{onClick:async()=>{window.confirm("Удалить страну и все связанные города?")&&await ei("country",s.id)&&(g.Am.success("Страна удалена"),await q())},className:"text-destructive focus:text-destructive",children:[(0,r.jsx)(C.Z,{className:"mr-2 h-4 w-4"}),"Удалить"]})]})]})})]},s.id))})]})})]})})()}),(0,r.jsx)(p.nU,{value:"cities",children:(()=>{let e="cities",t=U[e],s=em.map(e=>e.id);return(0,r.jsxs)(c.Zb,{children:[(0,r.jsxs)(c.Ol,{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(c.ll,{children:"Города"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground mt-2",children:"Управляйте списком городов и их принадлежностью к странам."})]}),(0,r.jsxs)("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(m.I,{placeholder:"Поиск города или страны...",value:L.cities,onChange:e=>W(t=>({...t,cities:e.target.value})),className:"h-9 w-full sm:w-64"}),(0,r.jsxs)(i.z,{variant:"outline",size:"sm",onClick:()=>ec("cities"),disabled:P,children:[(0,r.jsx)(b,{className:"mr-2 h-4 w-4"}),"Системный промпт"]})]}),(0,r.jsxs)(i.z,{size:"sm",onClick:()=>er("cities"),children:[(0,r.jsx)(v.Z,{className:"mr-2 h-4 w-4"}),"Добавить город"]})]})]}),(0,r.jsx)(c.aY,{children:Z?(0,r.jsx)("div",{className:"space-y-2",children:Array.from({length:6}).map((e,t)=>(0,r.jsx)(x.O,{className:"h-10 w-full"},t))}):0===em.length?(0,r.jsx)("div",{className:"py-10 text-center text-sm text-muted-foreground",children:"Города не найдены."}):(0,r.jsxs)(h.iA,{children:[(0,r.jsx)(h.xD,{children:(0,r.jsxs)(h.SC,{children:[(0,r.jsx)(h.ss,{className:"w-12",children:(0,r.jsx)(o.X,{checked:em.length>0&&s.every(e=>t.has(e)),onCheckedChange:()=>et(e,s)})}),(0,r.jsx)(h.ss,{children:"Город"}),(0,r.jsx)(h.ss,{children:"Страна"}),(0,r.jsx)(h.ss,{className:"w-16 text-right",children:"Действия"})]})}),(0,r.jsx)(h.RM,{children:em.map(s=>(0,r.jsxs)(h.SC,{children:[(0,r.jsx)(h.pj,{children:(0,r.jsx)(o.X,{checked:t.has(s.id),onCheckedChange:()=>ee(e,s.id)})}),(0,r.jsx)(h.pj,{className:"font-medium",children:s.name}),(0,r.jsx)(h.pj,{children:s.countryName}),(0,r.jsx)(h.pj,{className:"text-right",children:(0,r.jsxs)(u.h_,{children:[(0,r.jsx)(u.$F,{asChild:!0,children:(0,r.jsx)(i.z,{variant:"ghost",size:"icon",className:"h-8 w-8",children:(0,r.jsx)(N,{className:"h-4 w-4"})})}),(0,r.jsxs)(u.AW,{align:"end",children:[(0,r.jsxs)(u.Xi,{onClick:()=>ea("cities",s.id,s.name,s.countryId),children:[(0,r.jsx)(w,{className:"mr-2 h-4 w-4"}),"Редактировать"]}),(0,r.jsxs)(u.Xi,{onClick:async()=>{window.confirm("Удалить город?")&&await ei("city",s.id)&&(g.Am.success("Город удалён"),await q())},className:"text-destructive focus:text-destructive",children:[(0,r.jsx)(C.Z,{className:"mr-2 h-4 w-4"}),"Удалить"]})]})]})})]},s.id))})]})})]})})()})]})]})}),(0,r.jsx)(d.Vq,{open:null!==V,onOpenChange:e=>!e&&O(null),children:(0,r.jsxs)(d.cZ,{className:"sm:max-w-lg",children:[(0,r.jsxs)(d.fK,{children:[(0,r.jsx)(d.$N,{children:(null==V?void 0:V.mode)==="create"?"Создать элемент":"Редактировать элемент"}),(0,r.jsx)(d.Be,{children:V?"Тип: ".concat(z[null!==(e=Object.keys(z).find(e=>z[e].type===V.type))&&void 0!==e?e:"categories"].label):""})]}),V&&(0,r.jsxs)("div",{className:"space-y-4 py-2",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(f._,{htmlFor:"taxonomy-name",children:"Название"}),(0,r.jsx)(m.I,{id:"taxonomy-name",value:V.name,onChange:e=>O(t=>t?{...t,name:e.target.value}:t),autoFocus:!0})]}),"city"===V.type&&(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(f._,{htmlFor:"taxonomy-country",children:"Страна"}),(0,r.jsxs)("select",{id:"taxonomy-country",className:"w-full rounded-md border bg-background px-3 py-2 text-sm",value:null!==(t=V.countryId)&&void 0!==t?t:"",onChange:e=>O(t=>t?{...t,countryId:e.target.value?Number(e.target.value):null}:t),children:[(0,r.jsx)("option",{value:"",children:"Выберите страну"}),A.countries.map(e=>(0,r.jsx)("option",{value:e.id,children:e.name},e.id))]})]})]}),(0,r.jsxs)(d.cN,{children:[(0,r.jsx)(i.z,{variant:"outline",onClick:()=>O(null),disabled:M,children:"Отмена"}),(0,r.jsx)(i.z,{onClick:en,disabled:M,children:M?"Сохранение...":"Сохранить"})]})]})}),(0,r.jsx)(d.Vq,{open:null!==_,onOpenChange:e=>!e&&E(null),children:(0,r.jsxs)(d.cZ,{className:"sm:max-w-xl",children:[(0,r.jsxs)(d.fK,{children:[(0,r.jsx)(d.$N,{children:_?R[_.type]:"Системный промпт"}),(0,r.jsx)(d.Be,{children:"Опишите правила для нейросети при назначении значений этого справочника."})]}),_&&(0,r.jsx)(j.g,{rows:8,value:_.value,onChange:e=>E(t=>t?{...t,value:e.target.value}:t),className:"resize-none"}),(0,r.jsxs)(d.cN,{children:[(0,r.jsx)(i.z,{variant:"outline",onClick:()=>E(null),disabled:H,children:"Отмена"}),(0,r.jsx)(i.z,{onClick:eo,disabled:H,children:H?"Сохранение...":"Сохранить"})]})]})}),ef>0&&(0,r.jsx)("div",{className:"fixed bottom-6 left-1/2 z-40 -translate-x-1/2",children:(0,r.jsx)(c.Zb,{className:"border-primary shadow-xl",children:(0,r.jsxs)(c.aY,{className:"flex items-center gap-4 py-3 px-6",children:[(0,r.jsxs)("span",{className:"text-sm",children:["Выбрано:"," ",(0,r.jsx)("span",{className:"font-semibold text-primary",children:ef})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsxs)(i.z,{variant:"destructive",size:"sm",onClick:()=>el(s),children:[(0,r.jsx)(C.Z,{className:"mr-2 h-4 w-4"}),"Удалить"]}),(0,r.jsx)(i.z,{variant:"ghost",size:"sm",onClick:()=>es(s),children:"Сбросить"})]})]})})})]})}},6219:function(e,t,s){"use strict";s.d(t,{P:function(){return d}});var r=s(7437),a=s(7138),n=s(6463),i=s(7440),l=s(495),c=s(1663),o=s(7776);function d(){let e=(0,n.usePathname)(),t=(0,n.useRouter)(),s=async()=>{try{(await fetch("/api/admin/logout",{method:"POST"})).ok&&(o.Am.success("Вы вышли из системы"),t.push("/admin/login"),t.refresh())}catch(e){console.error("Logout error:",e),o.Am.error("Ошибка при выходе")}};return(0,r.jsx)("header",{className:"sticky top-0 z-50 w-full border-b bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60",children:(0,r.jsxs)("div",{className:"container flex h-16 items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex gap-6 md:gap-10",children:[(0,r.jsx)(a.default,{href:"/admin",className:"flex items-center space-x-2",children:(0,r.jsxs)("span",{className:"text-xl font-bold tracking-tight",children:["SYNDICATE ",(0,r.jsx)("span",{className:"text-primary",children:"admin"})]})}),(0,r.jsx)("nav",{className:"flex items-center gap-6",children:[{href:"/admin",label:"Дашборд"},{href:"/admin/materials",label:"Материалы"},{href:"/admin/rss",label:"RSS фиды"},{href:"/admin/taxonomy",label:"Справочники"},{href:"/admin/logs",label:"Логи"},{href:"/admin/settings",label:"Настройки"}].map(t=>(0,r.jsx)(a.default,{href:t.href,className:(0,i.cn)("text-sm font-medium transition-colors hover:text-primary",e===t.href?"text-foreground":"text-muted-foreground"),children:t.label},t.href))})]}),(0,r.jsxs)(l.z,{variant:"ghost",size:"sm",onClick:s,children:[(0,r.jsx)(c.Z,{className:"mr-2 h-4 w-4"}),"Выход"]})]})})}},4693:function(e,t,s){"use strict";s.d(t,{C:function(){return l}});var r=s(7437);s(2265);var a=s(3027),n=s(7440);let i=(0,a.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function l(e){let{className:t,variant:s,...a}=e;return(0,r.jsx)("div",{className:(0,n.cn)(i({variant:s}),t),...a})}},495:function(e,t,s){"use strict";s.d(t,{d:function(){return c},z:function(){return o}});var r=s(7437),a=s(2265),n=s(1538),i=s(3027),l=s(7440);let c=(0,i.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),o=a.forwardRef((e,t)=>{let{className:s,variant:a,size:i,asChild:o=!1,...d}=e,u=o?n.g7:"button";return(0,r.jsx)(u,{className:(0,l.cn)(c({variant:a,size:i,className:s})),ref:t,...d})});o.displayName="Button"},6013:function(e,t,s){"use strict";s.d(t,{Ol:function(){return l},SZ:function(){return o},Zb:function(){return i},aY:function(){return d},ll:function(){return c}});var r=s(7437),a=s(2265),n=s(7440);let i=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",s),...a})});i.displayName="Card";let l=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",s),...a})});l.displayName="CardHeader";let c=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("h3",{ref:t,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",s),...a})});c.displayName="CardTitle";let o=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("p",{ref:t,className:(0,n.cn)("text-sm text-muted-foreground",s),...a})});o.displayName="CardDescription";let d=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("p-6 pt-0",s),...a})});d.displayName="CardContent",a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("flex items-center p-6 pt-0",s),...a})}).displayName="CardFooter"},6466:function(e,t,s){"use strict";s.d(t,{X:function(){return c}});var r=s(7437),a=s(2265),n=s(6772),i=s(4374),l=s(7440);let c=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(n.fC,{ref:t,className:(0,l.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",s),...a,children:(0,r.jsx)(n.z$,{className:(0,l.cn)("flex items-center justify-center text-current"),children:(0,r.jsx)(i.Z,{className:"h-4 w-4"})})})});c.displayName=n.fC.displayName},837:function(e,t,s){"use strict";s.d(t,{$N:function(){return x},Be:function(){return h},Vq:function(){return c},cN:function(){return f},cZ:function(){return u},fK:function(){return m}});var r=s(7437),a=s(2265),n=s(2226),i=s(870),l=s(7440);let c=n.fC;n.xz;let o=n.h_;n.x8;let d=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(n.aV,{ref:t,className:(0,l.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...a})});d.displayName=n.aV.displayName;let u=a.forwardRef((e,t)=>{let{className:s,children:a,...c}=e;return(0,r.jsxs)(o,{children:[(0,r.jsx)(d,{}),(0,r.jsxs)(n.VY,{ref:t,className:(0,l.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-4xl translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] rounded-lg max-h-[90vh] overflow-y-auto",s),...c,children:[a,(0,r.jsxs)(n.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,r.jsx)(i.Z,{className:"h-4 w-4"}),(0,r.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});u.displayName=n.VY.displayName;let m=e=>{let{className:t,...s}=e;return(0,r.jsx)("div",{className:(0,l.cn)("flex flex-col space-y-1.5 text-center sm:text-left",t),...s})};m.displayName="DialogHeader";let f=e=>{let{className:t,...s}=e;return(0,r.jsx)("div",{className:(0,l.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...s})};f.displayName="DialogFooter";let x=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(n.Dx,{ref:t,className:(0,l.cn)("text-lg font-semibold leading-none tracking-tight",s),...a})});x.displayName=n.Dx.displayName;let h=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(n.dk,{ref:t,className:(0,l.cn)("text-sm text-muted-foreground",s),...a})});h.displayName=n.dk.displayName},6910:function(e,t,s){"use strict";s.d(t,{$F:function(){return d},AW:function(){return u},Ju:function(){return x},VD:function(){return h},Xi:function(){return m},bO:function(){return f},h_:function(){return o}});var r=s(7437),a=s(2265),n=s(8402),i=s(9346),l=s(4374),c=s(7440);let o=n.fC,d=n.xz;n.ZA,n.Uv,n.Tr,n.Ee,a.forwardRef((e,t)=>{let{className:s,inset:a,children:l,...o}=e;return(0,r.jsxs)(n.fF,{ref:t,className:(0,c.cn)("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",a&&"pl-8",s),...o,children:[l,(0,r.jsx)(i.Z,{className:"ml-auto h-4 w-4"})]})}).displayName=n.fF.displayName,a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(n.tu,{ref:t,className:(0,c.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...a})}).displayName=n.tu.displayName;let u=a.forwardRef((e,t)=>{let{className:s,sideOffset:a=4,...i}=e;return(0,r.jsx)(n.Uv,{children:(0,r.jsx)(n.VY,{ref:t,sideOffset:a,className:(0,c.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...i})})});u.displayName=n.VY.displayName;let m=a.forwardRef((e,t)=>{let{className:s,inset:a,...i}=e;return(0,r.jsx)(n.ck,{ref:t,className:(0,c.cn)("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a&&"pl-8",s),...i})});m.displayName=n.ck.displayName;let f=a.forwardRef((e,t)=>{let{className:s,children:a,checked:i,...o}=e;return(0,r.jsxs)(n.oC,{ref:t,className:(0,c.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),checked:i,...o,children:[(0,r.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,r.jsx)(n.wU,{children:(0,r.jsx)(l.Z,{className:"h-4 w-4"})})}),a]})});f.displayName=n.oC.displayName,a.forwardRef((e,t)=>{let{className:s,children:a,...i}=e;return(0,r.jsxs)(n.Rk,{ref:t,className:(0,c.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...i,children:[(0,r.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,r.jsx)(n.wU,{children:(0,r.jsx)("span",{className:"h-2 w-2 rounded-full bg-current"})})}),a]})}).displayName=n.Rk.displayName;let x=a.forwardRef((e,t)=>{let{className:s,inset:a,...i}=e;return(0,r.jsx)(n.__,{ref:t,className:(0,c.cn)("px-2 py-1.5 text-sm font-semibold",a&&"pl-8",s),...i})});x.displayName=n.__.displayName;let h=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(n.Z0,{ref:t,className:(0,c.cn)("-mx-1 my-1 h-px bg-muted",s),...a})});h.displayName=n.Z0.displayName},3102:function(e,t,s){"use strict";s.d(t,{I:function(){return i}});var r=s(7437),a=s(2265),n=s(7440);let i=a.forwardRef((e,t)=>{let{className:s,type:a,...i}=e;return(0,r.jsx)("input",{type:a,className:(0,n.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s),ref:t,...i})});i.displayName="Input"},7135:function(e,t,s){"use strict";s.d(t,{_:function(){return o}});var r=s(7437),a=s(2265),n=s(8837),i=s(3027),l=s(7440);let c=(0,i.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),o=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(n.f,{ref:t,className:(0,l.cn)(c(),s),...a})});o.displayName=n.f.displayName},2738:function(e,t,s){"use strict";s.d(t,{O:function(){return n}});var r=s(7437),a=s(7440);function n(e){let{className:t,...s}=e;return(0,r.jsx)("div",{className:(0,a.cn)("animate-pulse rounded-md bg-muted",t),...s})}},6975:function(e,t,s){"use strict";s.d(t,{RM:function(){return c},SC:function(){return o},iA:function(){return i},pj:function(){return u},ss:function(){return d},xD:function(){return l}});var r=s(7437),a=s(2265),n=s(7440);let i=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{className:"relative w-full overflow-auto",children:(0,r.jsx)("table",{ref:t,className:(0,n.cn)("w-full caption-bottom text-sm",s),...a})})});i.displayName="Table";let l=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("thead",{ref:t,className:(0,n.cn)("[&_tr]:border-b",s),...a})});l.displayName="TableHeader";let c=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("tbody",{ref:t,className:(0,n.cn)("[&_tr:last-child]:border-0",s),...a})});c.displayName="TableBody",a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("tfoot",{ref:t,className:(0,n.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",s),...a})}).displayName="TableFooter";let o=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("tr",{ref:t,className:(0,n.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",s),...a})});o.displayName="TableRow";let d=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("th",{ref:t,className:(0,n.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",s),...a})});d.displayName="TableHead";let u=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("td",{ref:t,className:(0,n.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",s),...a})});u.displayName="TableCell",a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("caption",{ref:t,className:(0,n.cn)("mt-4 text-sm text-muted-foreground",s),...a})}).displayName="TableCaption"},5273:function(e,t,s){"use strict";s.d(t,{SP:function(){return o},dr:function(){return c},mQ:function(){return l},nU:function(){return d}});var r=s(7437),a=s(2265),n=s(2447),i=s(7440);let l=n.fC,c=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(n.aV,{ref:t,className:(0,i.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",s),...a})});c.displayName=n.aV.displayName;let o=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(n.xz,{ref:t,className:(0,i.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",s),...a})});o.displayName=n.xz.displayName;let d=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(n.VY,{ref:t,className:(0,i.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",s),...a})});d.displayName=n.VY.displayName},3146:function(e,t,s){"use strict";s.d(t,{g:function(){return i}});var r=s(7437),a=s(2265),n=s(7440);let i=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("textarea",{className:(0,n.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s),ref:t,...a})});i.displayName="Textarea"},7440:function(e,t,s){"use strict";s.d(t,{cn:function(){return n}});var r=s(4839),a=s(6164);function n(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,a.m6)((0,r.W)(t))}},2447:function(e,t,s){"use strict";s.d(t,{VY:function(){return T},aV:function(){return S},fC:function(){return A},xz:function(){return Z}});var r=s(2265),a=s(8149),n=s(8324),i=s(3398),l=s(1383),c=s(8676),o=s(7513),d=s(1715),u=s(3201),m=s(7437),f="Tabs",[x,h]=(0,n.b)(f,[i.Pc]),p=(0,i.Pc)(),[j,g]=x(f),y=r.forwardRef((e,t)=>{let{__scopeTabs:s,value:r,onValueChange:a,defaultValue:n,orientation:i="horizontal",dir:l,activationMode:x="automatic",...h}=e,p=(0,o.gm)(l),[g,y]=(0,d.T)({prop:r,onChange:a,defaultProp:null!=n?n:"",caller:f});return(0,m.jsx)(j,{scope:s,baseId:(0,u.M)(),value:g,onValueChange:y,orientation:i,dir:p,activationMode:x,children:(0,m.jsx)(c.WV.div,{dir:p,"data-orientation":i,...h,ref:t})})});y.displayName=f;var b="TabsList",v=r.forwardRef((e,t)=>{let{__scopeTabs:s,loop:r=!0,...a}=e,n=g(b,s),l=p(s);return(0,m.jsx)(i.fC,{asChild:!0,...l,orientation:n.orientation,dir:n.dir,loop:r,children:(0,m.jsx)(c.WV.div,{role:"tablist","aria-orientation":n.orientation,...a,ref:t})})});v.displayName=b;var N="TabsTrigger",w=r.forwardRef((e,t)=>{let{__scopeTabs:s,value:r,disabled:n=!1,...l}=e,o=g(N,s),d=p(s),u=z(o.baseId,r),f=R(o.baseId,r),x=r===o.value;return(0,m.jsx)(i.ck,{asChild:!0,...d,focusable:!n,active:x,children:(0,m.jsx)(c.WV.button,{type:"button",role:"tab","aria-selected":x,"aria-controls":f,"data-state":x?"active":"inactive","data-disabled":n?"":void 0,disabled:n,id:u,...l,ref:t,onMouseDown:(0,a.Mj)(e.onMouseDown,e=>{n||0!==e.button||!1!==e.ctrlKey?e.preventDefault():o.onValueChange(r)}),onKeyDown:(0,a.Mj)(e.onKeyDown,e=>{[" ","Enter"].includes(e.key)&&o.onValueChange(r)}),onFocus:(0,a.Mj)(e.onFocus,()=>{let e="manual"!==o.activationMode;x||n||!e||o.onValueChange(r)})})})});w.displayName=N;var C="TabsContent",k=r.forwardRef((e,t)=>{let{__scopeTabs:s,value:a,forceMount:n,children:i,...o}=e,d=g(C,s),u=z(d.baseId,a),f=R(d.baseId,a),x=a===d.value,h=r.useRef(x);return r.useEffect(()=>{let e=requestAnimationFrame(()=>h.current=!1);return()=>cancelAnimationFrame(e)},[]),(0,m.jsx)(l.z,{present:n||x,children:s=>{let{present:r}=s;return(0,m.jsx)(c.WV.div,{"data-state":x?"active":"inactive","data-orientation":d.orientation,role:"tabpanel","aria-labelledby":u,hidden:!r,id:f,tabIndex:0,...o,ref:t,style:{...e.style,animationDuration:h.current?"0s":void 0},children:r&&i})}})});function z(e,t){return"".concat(e,"-trigger-").concat(t)}function R(e,t){return"".concat(e,"-content-").concat(t)}k.displayName=C;var A=y,S=v,Z=w,T=k},5388:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(7934).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])}},function(e){e.O(0,[876,776,138,650,413,398,402,395,971,23,744],function(){return e(e.s=8363)}),_N_E=e.O()}]);