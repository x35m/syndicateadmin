"use strict";(()=>{var e={};e.id=149,e.ids=[149],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},5900:e=>{e.exports=require("pg")},9610:(e,t,a)=>{a.r(t),a.d(t,{originalPathname:()=>I,patchFetch:()=>h,requestAsyncStorage:()=>g,routeModule:()=>d,serverHooks:()=>f,staticGenerationAsyncStorage:()=>m});var s={};a.r(s),a.d(s,{DELETE:()=>c,GET:()=>u,PATCH:()=>p});var r=a(9303),o=a(8716),i=a(670),n=a(7070),l=a(9487);async function u(e){try{let t;let{searchParams:a}=new URL(e.url),s=a.get("status"),r=a.get("page")?parseInt(a.get("page")):void 0,o=a.get("pageSize")?parseInt(a.get("pageSize")):void 0,i=a.get("search")||void 0,u=a.get("categoryIds")?.split(",").map(Number).filter(Boolean),p=a.get("themeIds")?.split(",").map(Number).filter(Boolean),c=a.get("tagIds")?.split(",").map(Number).filter(Boolean),d=a.get("allianceIds")?.split(",").map(Number).filter(Boolean),g=a.get("countryIds")?.split(",").map(Number).filter(Boolean),m=a.get("cityIds")?.split(",").map(Number).filter(Boolean),f=a.get("feedNames")?.split(",").filter(Boolean),I="true"===a.get("onlyWithSummary");if(void 0!==r||void 0!==o||i||u||p||c||d||g||m||f||I){let e=await l.db.getMaterialsPaginated({page:r,pageSize:o,status:s||void 0,search:i,categoryIds:u,themeIds:p,tagIds:c,allianceIds:d,countryIds:g,cityIds:m,feedNames:f,onlyWithSummary:I}),t=await l.db.getStats();return n.NextResponse.json({success:!0,data:e.materials,pagination:{page:e.page,pageSize:e.pageSize,total:e.total,totalPages:e.totalPages},stats:{total:parseInt(t.total||"0"),new:parseInt(t.new_count||"0"),processed:parseInt(t.processed_count||"0"),archived:parseInt(t.archived_count||"0")}})}t=s&&"all"!==s?await l.db.getMaterialsByStatus(s):await l.db.getAllMaterials();let h=await l.db.getStats();return n.NextResponse.json({success:!0,data:t,stats:{total:parseInt(h.total||"0"),new:parseInt(h.new_count||"0"),processed:parseInt(h.processed_count||"0"),archived:parseInt(h.archived_count||"0")}})}catch(e){return console.error("API Error:",e),n.NextResponse.json({success:!1,error:"Failed to fetch materials"},{status:500})}}async function p(e){try{let{id:t,status:a}=await e.json();if(!t||!a)return n.NextResponse.json({success:!1,error:"Missing id or status"},{status:400});return await l.db.updateMaterialStatus(t,a),n.NextResponse.json({success:!0,message:"Material updated successfully"})}catch(e){return console.error("API Error:",e),n.NextResponse.json({success:!1,error:"Failed to update material"},{status:500})}}async function c(e){try{let{searchParams:t}=new URL(e.url),a=t.get("id");if(!a)return n.NextResponse.json({success:!1,error:"Missing material ID"},{status:400});return await l.db.deleteMaterial(a),n.NextResponse.json({success:!0,message:"Material deleted successfully"})}catch(e){return console.error("API Error:",e),n.NextResponse.json({success:!1,error:"Failed to delete material"},{status:500})}}let d=new r.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/materials/route",pathname:"/api/materials",filename:"route",bundlePath:"app/api/materials/route"},resolvedPagePath:"/Users/macbookpro/Desktop/syndicateadmin/app/api/materials/route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:g,staticGenerationAsyncStorage:m,serverHooks:f}=d,I="/api/materials/route";function h(){return(0,i.patchFetch)({serverHooks:f,staticGenerationAsyncStorage:m})}}};var t=require("../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),s=t.X(0,[948,972,487],()=>a(9610));module.exports=s})();