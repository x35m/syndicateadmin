(()=>{var e={};e.id=227,e.ids=[227],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},5900:e=>{"use strict";e.exports=require("pg")},9261:e=>{"use strict";e.exports=require("postcss")},2081:e=>{"use strict";e.exports=require("child_process")},6113:e=>{"use strict";e.exports=require("crypto")},2361:e=>{"use strict";e.exports=require("events")},3685:e=>{"use strict";e.exports=require("http")},5687:e=>{"use strict";e.exports=require("https")},1017:e=>{"use strict";e.exports=require("path")},5477:e=>{"use strict";e.exports=require("punycode")},2781:e=>{"use strict";e.exports=require("stream")},7310:e=>{"use strict";e.exports=require("url")},9796:e=>{"use strict";e.exports=require("zlib")},3934:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>i.a,__next_app__:()=>u,originalPathname:()=>m,pages:()=>o,routeModule:()=>x,tree:()=>d}),t(2227),t(596),t(7489),t(5866);var a=t(3191),r=t(8716),n=t(7922),i=t.n(n),l=t(5231),c={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>l[e]);t.d(s,c);let d=["",{children:["admin",{children:["materials",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,2227)),"/Users/macbookpro/Desktop/syndicateadmin/app/admin/materials/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,596)),"/Users/macbookpro/Desktop/syndicateadmin/app/admin/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,7489)),"/Users/macbookpro/Desktop/syndicateadmin/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,5866,23)),"next/dist/client/components/not-found-error"]}],o=["/Users/macbookpro/Desktop/syndicateadmin/app/admin/materials/page.tsx"],m="/admin/materials/page",u={require:t,loadChunk:()=>Promise.resolve()},x=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/admin/materials/page",pathname:"/admin/materials",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},359:(e,s,t)=>{Promise.resolve().then(t.bind(t,3752))},3752:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>E});var a=t(326),r=t(7577),n=t(772),i=t(2643),l=t(5940),c=t(567),d=t(2288),o=t(1677),m=t(3427),u=t(3313),x=t(5304),h=t(4432),p=t(7673),f=t(1048),g=t(6694),j=t(9492),y=t(770),N=t(4674),v=t(7926);let b=(0,v.Z)("PauseCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"10",x2:"10",y1:"15",y2:"9",key:"c1nkhi"}],["line",{x1:"14",x2:"14",y1:"15",y2:"9",key:"h65svq"}]]),w=(0,v.Z)("StopCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["rect",{width:"6",height:"6",x:"9",y:"9",key:"1wrtvo"}]]),k=(0,v.Z)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["polyline",{points:"22 4 12 14.01 9 11.01",key:"6xbx8j"}]]),C=(0,v.Z)("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]);var S=t(8120),z=t(3183),I=t(4459),$=t(6840),A=t(6562),Z=t(3495),R=t(380),D=t(2959),M=t(3796),O=t(5999),P=t(97);let q={search:"",categories:[],countries:[],cities:[],feeds:[]},_={"generate-summary":{label:"Генерация саммари",successMessage:"Генерация завершена успешно"},published:{label:"Публикация",successMessage:"Публикация завершена успешно"},archived:{label:"Архивирование",successMessage:"Архивирование завершено"},delete:{label:"Удаление",successMessage:"Удаление завершено"}};function T({label:e,options:s,selected:t,onChange:i,disabled:l,fullWidth:d,maxSelected:o}){let[m,u]=(0,r.useState)(""),x=e=>{if(t.includes(e))i(t.filter(s=>s!==e));else if(o&&o>0){if(1===o)i([e]);else{let s=[...t,e],a=s.length-o;a>0&&s.splice(0,a),i(s)}}else i([...t,e])},p=(0,r.useMemo)(()=>{let e=m.trim().toLowerCase();return e?s.filter(s=>s.label.toLowerCase().includes(e)):s},[s,m]);return(0,a.jsxs)(P.h_,{onOpenChange:e=>!e&&u(""),children:[a.jsx(P.$F,{asChild:!0,disabled:l,children:(0,a.jsxs)(n.z,{variant:"outline",size:"sm",className:`${d?"w-full":"min-w-[180px]"} justify-between`,children:[(0,a.jsxs)("span",{className:"flex items-center gap-2 text-sm",children:[a.jsx("span",{children:e}),t.length>0&&a.jsx(c.C,{variant:"secondary",className:"px-1 text-xs font-medium",children:t.length})]}),a.jsx(g.Z,{className:"h-3 w-3 text-muted-foreground"})]})}),(0,a.jsxs)(P.AW,{align:"start",className:`${d?"w-80":"w-64"} max-h-64 overflow-y-auto`,children:[a.jsx(P.Ju,{children:e}),a.jsx(P.VD,{}),a.jsx("div",{className:"p-1",children:a.jsx(h.I,{placeholder:"Поиск...",value:m,onChange:e=>u(e.target.value),className:"h-8"})}),a.jsx(P.VD,{}),0===p.length?a.jsx("div",{className:"px-2 py-1.5 text-xs text-muted-foreground",children:"Ничего не найдено"}):p.map(e=>a.jsx(P.bO,{checked:t.includes(e.value),onCheckedChange:()=>x(e.value),children:e.label},String(e.value)))]})]})}function E(){let[e,s]=(0,r.useState)([]),[t,g]=(0,r.useState)(!0),[v,P]=(0,r.useState)("all"),[E,V]=(0,r.useState)(null),[F,L]=(0,r.useState)(!1),[U,Y]=(0,r.useState)(!1),[H,W]=(0,r.useState)(new Set),[J,G]=(0,r.useState)(null),K=(0,r.useRef)(!1),[X,B]=(0,r.useState)(null),[Q,ee]=(0,r.useState)({total:0,new:0,processed:0,published:0,archived:0}),[es,et]=(0,r.useState)(1),[ea,er]=(0,r.useState)(50),[en,ei]=(0,r.useState)(1),[el,ec]=(0,r.useState)(0),[ed,eo]=(0,r.useState)({categories:[],countries:[]}),[em,eu]=(0,r.useState)(!1),[ex,eh]=(0,r.useState)(q),[ep,ef]=(0,r.useState)(!1),[eg,ej]=(0,r.useState)(!1),[ey,eN]=(0,r.useState)(null),[ev,eb]=(0,r.useState)({category:"",country:"",city:""}),[ew,ek]=(0,r.useState)({categoryIds:[],countryIds:[],cityIds:[]}),[eC,eS]=(0,r.useState)(""),[ez,eI]=(0,r.useState)(""),[e$,eA]=(0,r.useState)(!1),eZ=(0,r.useMemo)(()=>{let s=new Set;return e.forEach(e=>{let t=e.feedName||e.source;t&&s.add(t)}),Array.from(s).sort((e,s)=>e.localeCompare(s,"ru"))},[e]),eR=(0,r.useMemo)(()=>{let e=[];return ed.countries.forEach(s=>{s.cities.forEach(t=>{e.push({value:t.id,label:`${t.name} — ${s.name}`})})}),e.sort((e,s)=>e.label.localeCompare(s.label,"ru"))},[ed.countries]),eD=(0,r.useMemo)(()=>!!E&&(eC!==(E.summary??"")||ez!==(E.metaDescription??"")),[E,eC,ez]),eM=(0,r.useMemo)(()=>ex.search.trim().length>0||ex.categories.length>0||ex.countries.length>0||ex.cities.length>0||ex.feeds.length>0,[ex]),eO=(0,r.useCallback)(async(e="all",t=es,a={})=>{let r=a.silent??!1;r||g(!0);try{let a=new URLSearchParams;a.set("status",e),a.set("page",t.toString()),a.set("pageSize",ea.toString()),ex.search&&a.set("search",ex.search),ex.categories.length>0&&a.set("categoryIds",ex.categories.join(",")),ex.countries.length>0&&a.set("countryIds",ex.countries.join(",")),ex.cities.length>0&&a.set("cityIds",ex.cities.join(",")),ex.feeds.length>0&&a.set("feedNames",ex.feeds.join(","));let r=await fetch(`/api/materials?${a.toString()}`),n=await r.json();n.success&&(s(n.data),n.pagination&&(ei(n.pagination.totalPages),ec(n.pagination.total),et(n.pagination.page)),ee(n.stats||{total:0,new:0,processed:0,published:0,archived:0}))}catch(e){console.error("Error fetching materials:",e)}finally{r||g(!1)}},[ex,ea,es]),eP=(0,r.useCallback)(async(e,s)=>{let t=await fetch("/api/materials",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e,...s})}),a=await t.json();if(!t.ok||!a.success)throw Error(a.error||"Не удалось обновить материал")},[]),eq=async()=>{try{eu(!0);let e=await fetch("/api/taxonomy"),s=await e.json();s.success?eo({categories:s.categories??[],countries:s.countries??[]}):O.Am.error(s.error||"Не удалось загрузить таксономию")}catch(e){console.error("Error fetching taxonomy:",e),O.Am.error("Не удалось загрузить таксономию")}finally{eu(!1)}},e_=e=>{if(J?.running){O.Am.info("Дождитесь завершения текущего процесса");return}if(0===H.size){O.Am.warning("Выберите материалы для обработки");return}B(e)},eT=(0,r.useCallback)(async()=>{if(!X)return;let s=Array.from(H);if(0===s.length){B(null),O.Am.warning("Нет выбранных материалов для обработки");return}B(null);let t=_[X];G({action:X,label:t.label,total:s.length,completed:0,success:0,failed:0,running:!0,stopRequested:!1,message:"Запуск...",errors:[]}),K.current=!1;let a=new Map(e.map(e=>[e.id,e])),r=[],n=0,i=0,l=0,c=e=>{G(s=>s?{...s,...e}:s)},d=e=>{c({completed:l,success:n,failed:i,message:e})},o=async(e,s)=>{await eP(e,s)};try{if("generate-summary"===X){for(let e of s){if(K.current){c({message:"Остановка запрошена. Завершаем процесс..."});break}let t=a.get(e);d(`Генерация саммари: ${t?.title??e}`);try{let s=await fetch("/api/materials/generate-summary",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({materialId:e})}),t=await s.json();if(!s.ok||!t.success)throw Error(t.error||"Не удалось сгенерировать саммари");n++}catch(s){i++,r.push({id:e,title:a.get(e)?.title??e,message:s instanceof Error?s.message:String(s)})}l++,d(`Обработано ${l}/${s.length}`)}n>0&&await eq()}else if("delete"===X)for(let e of s){if(K.current){c({message:"Остановка запрошена. Завершаем процесс..."});break}let t=a.get(e);d(`Удаление: ${t?.title??e}`);try{let s=await fetch(`/api/materials?id=${e}`,{method:"DELETE"});if(!s.ok){let e=await s.json().catch(()=>null);throw Error(e?.error||"Не удалось удалить материал")}n++}catch(s){i++,r.push({id:e,title:t?.title??e,message:s instanceof Error?s.message:String(s)})}l++,d(`Обработано ${l}/${s.length}`)}else if("archived"===X)for(let e of s){if(K.current){c({message:"Остановка запрошена. Завершаем процесс..."});break}let t=a.get(e);d(`Архивирование: ${t?.title??e}`);try{await o(e,{status:"archived",published:!1}),n++}catch(s){i++,r.push({id:e,title:t?.title??e,message:s instanceof Error?s.message:String(s)})}l++,d(`Обработано ${l}/${s.length}`)}else if("published"===X)for(let e of s){if(K.current){c({message:"Остановка запрошена. Завершаем процесс..."});break}let t=a.get(e);if(d(`Публикация: ${t?.title??e}`),!t){i++,r.push({id:e,title:e,message:"Материал не найден в текущем списке"}),l++,d(`Обработано ${l}/${s.length}`);continue}if(!t.summary||0===t.summary.trim().length){i++,r.push({id:e,title:t.title,message:"У материала отсутствует саммари, публикация невозможна"}),l++,d(`Обработано ${l}/${s.length}`);continue}try{await o(e,{published:!0}),n++}catch(s){i++,r.push({id:e,title:t.title,message:s instanceof Error?s.message:String(s)})}l++,d(`Обработано ${l}/${s.length}`)}}catch(e){r.push({id:"system",title:"Системная ошибка",message:e instanceof Error?e.message:String(e)})}finally{await eO(v,es,{silent:!0}),W(new Set);let e=K.current;K.current=!1;let a=s.length,d=l,o=n,m=i,u="";u=e&&d<a?`Процесс остановлен пользователем. Обработано ${d} из ${a}.`:0===m?`${t.successMessage}. Обработано ${o} из ${a}.`:0===o?`Не удалось выполнить действие. Ошибок: ${m}.`:`Выполнено с ошибками: успешно ${o}, ошибок ${m}.`,c({running:!1,stopRequested:e,completed:d,success:o,failed:m,message:u,errors:r}),e&&d<a?(0,O.Am)(u):0===m?O.Am.success(u):O.Am.warning(u)}},[X,H,e,v,es,eO,eq,eP]),eE=async e=>{P(e),eh(q),await eO(e),W(new Set),et(1)},eV=e=>{V(e),ek({categoryIds:e.categories?.length?[e.categories[0].id]:[],countryIds:e.countries?.map(e=>e.id)??[],cityIds:e.cities?.map(e=>e.id)??[]}),eS(e.summary??""),eI(e.metaDescription??""),Y(!1),L(!0)},eF=(es-1)*ea,eL=eF+e.length,eU=e=>{et(Math.max(1,Math.min(e,en)))},eY=e=>{er(e),et(1)},eH=e=>{if(J?.running)return;let s=new Set(H);s.has(e)?s.delete(e):s.add(e),W(s)},eW=(e,s)=>{ek(t=>{let a=new Set(t[e]);return a.delete(s),{...t,[e]:Array.from(a)}})},eJ=e=>{ek(s=>({...s,[e]:[]}))},eG=e=>s=>{eb(t=>({...t,[e]:s.target.value}))},eK=async e=>{let s=ev[e];if(!s.trim()){O.Am.warning("Введите название");return}if("city"===e){if(0===ew.countryIds.length){O.Am.warning("Выберите хотя бы одну страну перед добавлением города");return}let t=ew.countryIds[0];try{eN(e);let a=await fetch("/api/taxonomy",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:e,name:s,countryId:t})}),r=await a.json();if(!r.success){O.Am.error(r.error||"Не удалось создать элемент");return}await eq(),ek(e=>({...e,cityIds:Array.from(new Set([...e.cityIds,r.data.id]))})),eb(s=>({...s,[e]:""})),O.Am.success("Элемент создан")}catch(e){console.error("Error creating taxonomy item:",e),O.Am.error("Ошибка при создании элемента")}finally{eN(null)}return}try{eN(e);let t=await fetch("/api/taxonomy",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:e,name:s})}),a=await t.json();if(!a.success){O.Am.error(a.error||"Не удалось создать элемент");return}switch(await eq(),e){case"category":ek(e=>({...e,categoryIds:[a.data.id]}));break;case"country":ek(e=>({...e,countryIds:Array.from(new Set([...e.countryIds,a.data.id]))}))}eb(s=>({...s,[e]:""})),O.Am.success("Элемент создан")}catch(e){console.error("Error creating taxonomy item:",e),O.Am.error("Ошибка при создании элемента")}finally{eN(null)}},eX=async()=>{if(E)try{eA(!0),ef(!0);let e=[];eD&&e.push(eP(E.id,{summary:eC,metaDescription:ez})),e.push(fetch("/api/materials/taxonomy",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({materialId:E.id,categoryIds:ew.categoryIds.slice(0,1),countryIds:ew.countryIds,cityIds:ew.cityIds})}).then(async e=>{let s=await e.json();if(!e.ok||!s.success)throw Error(s.error||"Не удалось сохранить таксономию");return s.data}));let[,t]=await Promise.all(e);t?(s(e=>e.map(e=>e.id===t.id?t:e)),V({...t,summary:eC,metaDescription:ez}),ek({categoryIds:t.categories?.length?[t.categories[0].id]:[],countryIds:t.countries?.map(e=>e.id)??[],cityIds:t.cities?.map(e=>e.id)??[]})):V(e=>e&&e.id===E.id?{...e,summary:eC,metaDescription:ez}:e),await eO(v,es,{silent:!0}),O.Am.success("Материал сохранён")}catch(e){console.error("Error saving material:",e),O.Am.error("Не удалось сохранить материал")}finally{eA(!1),ef(!1)}},eB=async()=>{if(E)try{ej(!0);let e=await fetch("/api/materials/regenerate-taxonomy",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({materialId:E.id})}),t=await e.json();if(!e.ok)throw Error(t.error||"Ошибка при регенерации таксономии");if(t.success&&t.data?.material){let e=t.data.material;V(e),eS(e.summary??""),eI(e.metaDescription??""),ek({categoryIds:e.categories?.length?[e.categories[0].id]:[],countryIds:e.countries?.map(e=>e.id)??[],cityIds:e.cities?.map(e=>e.id)??[]}),s(s=>s.map(s=>s.id===e.id?e:s)),O.Am.success("Таксономия успешно обновлена"),await eq()}}catch(e){console.error("Error regenerating taxonomy:",e),O.Am.error(e.message||"Ошибка при регенерации таксономии")}finally{ej(!1)}},eQ=e=>{switch(e){case"new":return a.jsx(c.C,{variant:"default",children:"Новый"});case"processed":return a.jsx(c.C,{variant:"secondary",className:"bg-green-500/10 text-green-700 dark:text-green-400",children:"Обработан"});case"published":return a.jsx(c.C,{variant:"secondary",className:"bg-blue-500/10 text-blue-700 dark:text-blue-400",children:"Опубликован"});case"archived":return a.jsx(c.C,{variant:"outline",children:"Архив"});default:return a.jsx(c.C,{children:e})}},e0=e=>{let s=new Date(e),t=String(s.getDate()).padStart(2,"0"),a=String(s.getMonth()+1).padStart(2,"0"),r=String(s.getFullYear()).slice(-2),n=String(s.getHours()).padStart(2,"0"),i=String(s.getMinutes()).padStart(2,"0");return`${t}.${a}.${r} ${n}:${i}`},e1=(()=>{let e=H.size;switch(X){case"published":return{title:"Опубликовать материалы",description:`Вы уверены, что хотите опубликовать ${e} материал(ов)?`,actionText:"Опубликовать",variant:"default"};case"archived":return{title:"Архивировать материалы",description:`Вы уверены, что хотите архивировать ${e} материал(ов)?`,actionText:"Архивировать",variant:"default"};case"delete":return{title:"Удалить материалы",description:`Вы уверены, что хотите удалить ${e} материал(ов)? Это действие необратимо!`,actionText:"Удалить",variant:"destructive"};case"generate-summary":return{title:"Генерация саммари",description:1===e?"Сгенерировать саммари для этого материала?":`Сгенерировать саммари для ${e} материалов?`,actionText:"Сгенерировать",variant:"default"};default:return null}})();return(0,a.jsxs)(a.Fragment,{children:[a.jsx(M.P,{}),a.jsx("div",{className:"min-h-screen bg-background p-8",children:(0,a.jsxs)("div",{className:"container space-y-6",children:[a.jsx("div",{className:"flex justify-between items-center",children:a.jsx(m.mQ,{value:v,onValueChange:eE,children:(0,a.jsxs)(m.dr,{children:[(0,a.jsxs)(m.SP,{value:"all",children:["Все ",Q.total>0&&(0,a.jsxs)("span",{className:"ml-1.5 text-xs",children:["(",Q.total,")"]})]}),(0,a.jsxs)(m.SP,{value:"new",children:["Новые ",Q.new>0&&(0,a.jsxs)("span",{className:"ml-1.5 text-xs",children:["(",Q.new,")"]})]}),(0,a.jsxs)(m.SP,{value:"processed",children:["Обработанные ",Q.processed>0&&(0,a.jsxs)("span",{className:"ml-1.5 text-xs",children:["(",Q.processed,")"]})]}),(0,a.jsxs)(m.SP,{value:"published",children:["Опубликованные ",Q.published>0&&(0,a.jsxs)("span",{className:"ml-1.5 text-xs",children:["(",Q.published,")"]})]}),(0,a.jsxs)(m.SP,{value:"archived",children:["Архив ",Q.archived>0&&(0,a.jsxs)("span",{className:"ml-1.5 text-xs",children:["(",Q.archived,")"]})]})]})})}),J?a.jsx("div",{className:"fixed bottom-8 left-1/2 -translate-x-1/2 z-50 animate-in slide-in-from-bottom-4 fade-in duration-300 w-[min(90vw,600px)]",children:a.jsx(i.Zb,{className:"border-primary shadow-2xl",children:(0,a.jsxs)(i.aY,{className:"py-4 px-6 space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,a.jsxs)("div",{children:[a.jsx("p",{className:"text-sm font-semibold",children:J.label}),a.jsx("p",{className:"text-xs text-muted-foreground",children:J.message}),(0,a.jsxs)("p",{className:"mt-2 text-xs text-muted-foreground",children:["Выполнено ",J.completed," из ",J.total,". Успешно ",J.success,", ошибок ",J.failed,"."]})]}),a.jsx("div",{className:"flex items-center justify-center rounded-full border bg-background p-2",children:J.running?a.jsx(j.Z,{className:"h-4 w-4 animate-spin text-primary"}):J.failed>0?a.jsx(y.Z,{className:"h-4 w-4 text-amber-500"}):a.jsx(N.Z,{className:"h-4 w-4 text-green-500"})})]}),a.jsx("div",{className:"h-2 w-full rounded-full bg-muted",children:a.jsx("div",{className:"h-2 rounded-full bg-primary transition-all",style:{width:`${J.total>0?Math.min(100,Math.round(J.completed/J.total*100)):0}%`}})}),J.errors.length>0&&(0,a.jsxs)("div",{className:"max-h-32 overflow-y-auto rounded-md border border-border/50 bg-muted/30 p-3 text-xs",children:[a.jsx("p",{className:"mb-2 font-semibold text-foreground",children:"Ошибки:"}),a.jsx("div",{className:"space-y-2",children:J.errors.map(e=>(0,a.jsxs)("div",{className:"space-y-1",children:[a.jsx("p",{className:"font-medium text-foreground break-words",children:e.title}),a.jsx("p",{className:"text-muted-foreground break-words",children:e.message})]},`${e.id}-${e.message}`))})]}),(0,a.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[a.jsx(n.z,{variant:"outline",size:"sm",onClick:()=>{J&&J.running&&!J.stopRequested&&(K.current=!0,G(e=>e?{...e,stopRequested:!0,message:"Остановка запрошена. Завершаем текущий элемент..."}:e))},disabled:!J.running||J.stopRequested,className:"flex items-center gap-2",children:J.stopRequested?(0,a.jsxs)(a.Fragment,{children:[a.jsx(b,{className:"h-4 w-4"}),"Остановка..."]}):J.running?(0,a.jsxs)(a.Fragment,{children:[a.jsx(w,{className:"h-4 w-4"}),"Остановить"]}):(0,a.jsxs)(a.Fragment,{children:[a.jsx(w,{className:"h-4 w-4"}),"Остановлено"]})}),a.jsx(n.z,{size:"sm",onClick:()=>{J&&(!J.running||J.stopRequested)&&(G(null),W(new Set))},disabled:J.running,children:"Закрыть"})]})]})})}):H.size>0&&a.jsx("div",{className:"fixed bottom-8 left-1/2 -translate-x-1/2 z-50 animate-in slide-in-from-bottom-4 fade-in duration-300",children:a.jsx(i.Zb,{className:"border-primary shadow-2xl",children:a.jsx(i.aY,{className:"py-4 px-6",children:(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)("span",{className:"text-sm font-medium",children:["Выбрано: ",a.jsx("span",{className:"text-primary font-bold",children:H.size})," материал(ов)"]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(n.z,{size:"sm",variant:"default",onClick:()=>e_("published"),children:[a.jsx(k,{className:"mr-2 h-4 w-4"}),"Опубликовать"]}),(0,a.jsxs)(n.z,{size:"sm",variant:"secondary",onClick:()=>e_("generate-summary"),children:[a.jsx(C,{className:"mr-2 h-4 w-4"}),"Саммари"]}),(0,a.jsxs)(n.z,{size:"sm",variant:"outline",onClick:()=>e_("archived"),children:[a.jsx(S.Z,{className:"mr-2 h-4 w-4"}),"Архивировать"]}),(0,a.jsxs)(n.z,{size:"sm",variant:"destructive",onClick:()=>e_("delete"),children:[a.jsx(z.Z,{className:"mr-2 h-4 w-4"}),"Удалить"]})]}),a.jsx(n.z,{size:"sm",variant:"ghost",onClick:()=>W(new Set),children:"Отменить"})]})})})}),(0,a.jsxs)(i.Zb,{children:[a.jsx(i.Ol,{children:(0,a.jsxs)(i.ll,{children:["Материалы (",el,")"]})}),(0,a.jsxs)(i.aY,{children:[(0,a.jsxs)("div",{className:"mb-4 flex flex-col gap-3 lg:flex-row lg:items-center lg:justify-between",children:[(0,a.jsxs)("div",{className:"flex flex-wrap gap-2",children:[a.jsx(h.I,{placeholder:"Поиск…",value:ex.search,onChange:e=>eh(s=>({...s,search:e.target.value})),className:"h-9 w-full sm:w-64"}),a.jsx(T,{label:"Категории",options:ed.categories.map(e=>({value:e.id,label:e.isHidden?`${e.name} (скрыта)`:e.name})),selected:ex.categories,onChange:e=>eh(s=>({...s,categories:e})),disabled:0===ed.categories.length}),a.jsx(T,{label:"Страны",options:ed.countries.map(e=>({value:e.id,label:e.name})),selected:ex.countries,onChange:e=>eh(s=>({...s,countries:e})),disabled:0===ed.countries.length}),a.jsx(T,{label:"Города",options:eR,selected:ex.cities,onChange:e=>eh(s=>({...s,cities:e})),disabled:0===eR.length}),a.jsx(T,{label:"Источники",options:eZ.map(e=>({value:e,label:e})),selected:ex.feeds,onChange:e=>eh(s=>({...s,feeds:e})),disabled:0===eZ.length})]}),a.jsx("div",{className:"flex flex-wrap items-center gap-2",children:a.jsx(n.z,{variant:"ghost",size:"sm",onClick:()=>eh(q),disabled:!eM,children:"Сбросить фильтры"})})]}),!t&&e.length>0&&(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4 pb-4 border-b",children:[a.jsx("div",{className:"flex items-center gap-2",children:(0,a.jsxs)("span",{className:"text-sm text-muted-foreground",children:["Показано ",0===e.length?0:eF+1,"-",eL," из ",el]})}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-sm text-muted-foreground",children:"На странице:"}),a.jsx("div",{className:"flex gap-1",children:[25,50,100,200].map(e=>a.jsx(n.z,{variant:ea===e?"default":"outline",size:"sm",onClick:()=>eY(e),className:"h-8 w-12",children:e},e))})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[a.jsx(n.z,{variant:"outline",size:"sm",onClick:()=>eU(1),disabled:1===es,className:"h-8 w-8 p-0",title:"Первая страница",children:a.jsx(I.Z,{className:"h-4 w-4"})}),a.jsx(n.z,{variant:"outline",size:"sm",onClick:()=>eU(es-1),disabled:1===es,className:"h-8 w-8 p-0",title:"Предыдущая страница",children:a.jsx($.Z,{className:"h-4 w-4"})}),(0,a.jsxs)("div",{className:"flex items-center gap-1 px-2",children:[a.jsx("span",{className:"text-sm font-medium",children:es}),a.jsx("span",{className:"text-sm text-muted-foreground",children:"из"}),a.jsx("span",{className:"text-sm font-medium",children:en})]}),a.jsx(n.z,{variant:"outline",size:"sm",onClick:()=>eU(es+1),disabled:es===en,className:"h-8 w-8 p-0",title:"Следующая страница",children:a.jsx(A.Z,{className:"h-4 w-4"})}),a.jsx(n.z,{variant:"outline",size:"sm",onClick:()=>eU(en),disabled:es===en,className:"h-8 w-8 p-0",title:"Последняя страница",children:a.jsx(Z.Z,{className:"h-4 w-4"})})]})]})]}),t?a.jsx("div",{className:"space-y-2",children:Array.from({length:10}).map((e,s)=>(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[a.jsx(x.O,{className:"h-12 w-12"}),a.jsx(x.O,{className:"h-16 w-16 rounded"}),(0,a.jsxs)("div",{className:"flex-1 space-y-2",children:[a.jsx(x.O,{className:"h-4 w-full"}),a.jsx(x.O,{className:"h-4 w-3/4"})]}),a.jsx(x.O,{className:"h-8 w-24"}),a.jsx(x.O,{className:"h-8 w-20"})]},s))}):0===e.length?a.jsx("div",{className:"text-center py-8 text-muted-foreground",children:eM?"Материалы по выбранным фильтрам не найдены.":"Нет материалов. Добавьте RSS фиды и синхронизируйте их на главной."}):(0,a.jsxs)(l.iA,{children:[a.jsx(l.xD,{children:(0,a.jsxs)(l.SC,{children:[a.jsx(l.ss,{className:"w-12",children:a.jsx(u.X,{checked:e.length>0&&e.every(e=>H.has(e.id)),onCheckedChange:()=>{if(!J?.running){if(H.size===e.length&&e.length>0){let s=new Set(H);e.forEach(e=>s.delete(e.id)),W(s)}else{let s=new Set(H);e.forEach(e=>s.add(e.id)),W(s)}}},disabled:!!J?.running})}),a.jsx(l.ss,{className:"w-20",children:"Обложка"}),a.jsx(l.ss,{className:"min-w-[300px]",children:"Заголовок"}),a.jsx(l.ss,{className:"w-[220px]",children:"Категории"}),a.jsx(l.ss,{children:"Источник"}),a.jsx(l.ss,{className:"w-[130px]",children:"Дата"}),a.jsx(l.ss,{className:"w-[140px]",children:"Статус"})]})}),a.jsx(l.RM,{children:J?.running?Array.from({length:Math.min(e.length||ea,ea)}).map((e,s)=>(0,a.jsxs)(l.SC,{children:[a.jsx(l.pj,{children:a.jsx(x.O,{className:"h-4 w-4 rounded"})}),a.jsx(l.pj,{children:a.jsx(x.O,{className:"h-16 w-16 rounded"})}),(0,a.jsxs)(l.pj,{children:[a.jsx(x.O,{className:"h-4 w-48"}),a.jsx(x.O,{className:"mt-2 h-4 w-64"})]}),a.jsx(l.pj,{children:a.jsx(x.O,{className:"h-4 w-40"})}),a.jsx(l.pj,{children:a.jsx(x.O,{className:"h-4 w-28"})}),a.jsx(l.pj,{children:a.jsx(x.O,{className:"h-4 w-24"})}),a.jsx(l.pj,{children:a.jsx(x.O,{className:"h-4 w-24"})})]},`bulk-skeleton-${s}`)):e.map(e=>(0,a.jsxs)(l.SC,{className:"cursor-pointer hover:bg-accent/50",children:[a.jsx(l.pj,{onClick:e=>e.stopPropagation(),children:a.jsx(u.X,{checked:H.has(e.id),onCheckedChange:()=>eH(e.id),disabled:!!J?.running})}),a.jsx(l.pj,{onClick:()=>!J?.running&&eV(e),children:e.thumbnail?a.jsx("img",{src:e.thumbnail,alt:e.title,className:"w-16 h-16 object-cover rounded",onError:e=>{e.currentTarget.style.display="none"}}):a.jsx("div",{className:"w-16 h-16 bg-muted rounded flex items-center justify-center text-xs text-muted-foreground",children:"Нет фото"})}),a.jsx(l.pj,{className:"font-medium",onClick:()=>!J?.running&&eV(e),children:a.jsx("div",{className:"line-clamp-3 leading-snug",children:e.title})}),a.jsx(l.pj,{onClick:()=>!J?.running&&eV(e),children:e.categories&&e.categories.length>0?(0,a.jsxs)("div",{className:"flex max-w-[220px] flex-wrap gap-1",children:[e.categories.slice(0,3).map(s=>a.jsx(c.C,{variant:"outline",className:"text-xs font-normal",children:s.name},`${e.id}-category-${s.id}`)),e.categories.length>3&&(0,a.jsxs)(c.C,{variant:"secondary",className:"text-xs font-normal",children:["+",e.categories.length-3]})]}):a.jsx("span",{className:"text-xs text-muted-foreground",children:"—"})}),a.jsx(l.pj,{onClick:()=>!J?.running&&eV(e),children:a.jsx("div",{className:"truncate max-w-[200px]",title:e.feedName||e.source,children:e.feedName||e.source||"—"})}),a.jsx(l.pj,{onClick:()=>!J?.running&&eV(e),children:e0(e.createdAt)}),a.jsx(l.pj,{onClick:()=>!J?.running&&eV(e),children:eQ(e.status)})]},e.id))})]}),!t&&e.length>0&&(0,a.jsxs)("div",{className:"flex items-center justify-between mt-4 pt-4 border-t",children:[a.jsx("div",{className:"flex items-center gap-2",children:(0,a.jsxs)("span",{className:"text-sm text-muted-foreground",children:["Показано ",0===e.length?0:eF+1,"-",eL," из ",el]})}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-sm text-muted-foreground",children:"На странице:"}),a.jsx("div",{className:"flex gap-1",children:[25,50,100,200].map(e=>a.jsx(n.z,{variant:ea===e?"default":"outline",size:"sm",onClick:()=>eY(e),className:"h-8 w-12",children:e},e))})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[a.jsx(n.z,{variant:"outline",size:"sm",onClick:()=>eU(1),disabled:1===es,className:"h-8 w-8 p-0",title:"Первая страница",children:a.jsx(I.Z,{className:"h-4 w-4"})}),a.jsx(n.z,{variant:"outline",size:"sm",onClick:()=>eU(es-1),disabled:1===es,className:"h-8 w-8 p-0",title:"Предыдущая страница",children:a.jsx($.Z,{className:"h-4 w-4"})}),(0,a.jsxs)("div",{className:"flex items-center gap-1 px-2",children:[a.jsx("span",{className:"text-sm font-medium",children:es}),a.jsx("span",{className:"text-sm text-muted-foreground",children:"из"}),a.jsx("span",{className:"text-sm font-medium",children:en})]}),a.jsx(n.z,{variant:"outline",size:"sm",onClick:()=>eU(es+1),disabled:es===en,className:"h-8 w-8 p-0",title:"Следующая страница",children:a.jsx(A.Z,{className:"h-4 w-4"})}),a.jsx(n.z,{variant:"outline",size:"sm",onClick:()=>eU(en),disabled:es===en,className:"h-8 w-8 p-0",title:"Последняя страница",children:a.jsx(Z.Z,{className:"h-4 w-4"})})]})]})]})]})]}),a.jsx(o.aR,{open:null!==X,onOpenChange:e=>!e&&B(null),children:(0,a.jsxs)(o._T,{children:[(0,a.jsxs)(o.fY,{children:[a.jsx(o.f$,{children:e1?.title}),a.jsx(o.yT,{children:e1?.description})]}),(0,a.jsxs)(o.xo,{children:[a.jsx(o.le,{children:"Отмена"}),a.jsx(o.OL,{onClick:eT,disabled:J?.running===!0,className:`${e1?.variant==="destructive"?"bg-destructive text-destructive-foreground hover:bg-destructive/90":""}`,children:e1?.actionText})]})]})}),a.jsx(d.Vq,{open:F,onOpenChange:L,children:(0,a.jsxs)(d.cZ,{className:"w-[min(95vw,1100px)] max-h-[85vh] overflow-y-auto",children:[(0,a.jsxs)(d.fK,{children:[a.jsx(d.$N,{className:"text-2xl pr-8",children:E?.title}),(0,a.jsxs)(d.Be,{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex flex-wrap gap-4 text-sm",children:[(0,a.jsxs)("span",{children:[a.jsx("strong",{children:"Автор:"})," ",E?.author||"—"]}),(0,a.jsxs)("span",{children:[a.jsx("strong",{children:"Источник:"})," ",E?.feedName||E?.source||"—"]}),(0,a.jsxs)("span",{children:[a.jsx("strong",{children:"Дата:"})," ",E&&e0(E.createdAt)]})]}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-2",children:[a.jsx(c.C,{variant:E?.processed?"secondary":"outline",className:E?.processed?"border-green-500/20 bg-green-500/10 text-green-700 dark:text-green-400":"text-muted-foreground",children:E?.processed?"Обработан":"Не обработан"}),a.jsx(c.C,{variant:E?.published?"secondary":"outline",className:E?.published?"border-blue-500/20 bg-blue-500/10 text-blue-700 dark:text-blue-400":"text-muted-foreground",children:E?.published?"Опубликован":"Не опубликован"})]})]})]}),(0,a.jsxs)("div",{className:"mt-6 space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-xs font-semibold uppercase tracking-wide text-muted-foreground",children:"Мета описание"}),(0,a.jsxs)("span",{className:"text-xs text-muted-foreground",children:[ez.length,"/160"]})]}),a.jsx(p.g,{value:ez,onChange:e=>eI(e.target.value),maxLength:160,rows:3,placeholder:"Краткое описание статьи"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-xs font-semibold uppercase tracking-wide text-muted-foreground",children:"Саммари"}),E?.summary&&a.jsx(c.C,{variant:"secondary",children:"AI"})]}),a.jsx(p.g,{value:eC,onChange:e=>eS(e.target.value),rows:6,placeholder:"Краткое саммари на 3-5 предложений"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[a.jsx("div",{className:"flex items-center justify-between",children:a.jsx("span",{className:"text-xs font-semibold uppercase tracking-wide text-muted-foreground",children:"Категории публикации"})}),a.jsx("div",{className:"flex flex-wrap gap-2",children:ew.categoryIds.length>0?ew.categoryIds.map(e=>ed.categories.find(s=>s.id===e)).filter(e=>!!e).map(e=>(0,a.jsxs)(c.C,{variant:e.isHidden?"outline":"secondary",className:"gap-1",children:[e.name,e.isHidden&&a.jsx("span",{className:"ml-1 rounded bg-muted px-1 text-[10px] uppercase text-muted-foreground",children:"скрыта"}),a.jsx(n.z,{type:"button",variant:"ghost",size:"icon",className:"h-4 w-4 text-muted-foreground hover:text-destructive",onClick:()=>eW("categoryIds",e.id),children:a.jsx(R.Z,{className:"h-3 w-3"})})]},`pub-category-${e.id}`)):a.jsx("span",{className:"text-xs text-muted-foreground",children:"У материала нет выбранных категорий"})})]})]}),(0,a.jsxs)("div",{className:"mt-6 space-y-3",children:[a.jsx(n.z,{variant:"outline",size:"sm",onClick:()=>Y(e=>!e),className:"w-full sm:w-56",children:U?"Скрыть полный текст":"Показать полный текст"}),U&&a.jsx("div",{className:"rounded-lg border bg-background p-4 text-sm leading-relaxed",children:E?.fullContent?a.jsx("div",{className:"prose prose-sm max-w-none dark:prose-invert",dangerouslySetInnerHTML:{__html:E.fullContent.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,"").replace(/on\w+="[^"]*"/g,"").replace(/on\w+='[^']*'/g,"")}}):a.jsx("p",{className:"text-foreground",children:E?.content})})]}),a.jsx("div",{className:"mt-6 space-y-6",children:em?a.jsx("div",{className:"text-sm text-muted-foreground",children:"Загрузка справочников..."}):(0,a.jsxs)("div",{className:"space-y-5",children:[(0,a.jsxs)("section",{className:"rounded-lg border bg-muted/30 p-4 space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-1",children:[a.jsx(f._,{className:"text-sm font-semibold",children:"Категории"}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Выберите 1–3 наиболее релевантных категории или добавьте новую."})]}),(0,a.jsxs)("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:gap-3",children:[a.jsx(T,{label:"Добавить из списка",options:ed.categories.map(e=>({value:e.id,label:e.isHidden?`${e.name} (скрыта)`:e.name})),selected:ew.categoryIds,onChange:e=>ek(s=>({...s,categoryIds:e})),disabled:0===ed.categories.length,fullWidth:!0,maxSelected:1}),a.jsx(n.z,{variant:"ghost",size:"sm",onClick:()=>eJ("categoryIds"),disabled:0===ew.categoryIds.length,className:"sm:w-auto w-full",children:"Очистить"})]}),a.jsx("div",{className:"flex flex-wrap gap-2",children:ew.categoryIds.length>0?ew.categoryIds.map(e=>{let s=ed.categories.find(s=>s.id===e);return s?(0,a.jsxs)(c.C,{variant:"secondary",className:"gap-1",children:[s.name,a.jsx("button",{type:"button",className:"ml-1 inline-flex h-4 w-4 items-center justify-center rounded-sm hover:text-destructive",onClick:()=>eW("categoryIds",e),children:a.jsx(R.Z,{className:"h-3 w-3"})})]},`selected-category-${e}`):null}):a.jsx("span",{className:"text-xs text-muted-foreground",children:"Категории не выбраны"})}),(0,a.jsxs)("div",{className:"space-y-2 border-t pt-4",children:[a.jsx(f._,{className:"text-xs font-medium text-muted-foreground",children:"Нет нужной категории?"}),(0,a.jsxs)("div",{className:"flex flex-col gap-2 sm:flex-row",children:[a.jsx(h.I,{value:ev.category,onChange:eG("category"),placeholder:"Название новой категории",className:"h-9"}),a.jsx(n.z,{size:"sm",onClick:()=>eK("category"),disabled:"category"===ey,children:"category"===ey?"Добавление...":"Добавить"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-5",children:[(0,a.jsxs)("section",{className:"rounded-lg border bg-muted/10 p-4 space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-1",children:[a.jsx(f._,{className:"text-sm font-semibold",children:"Страны"}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Укажите страны, к которым относится материал."})]}),(0,a.jsxs)("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:gap-3",children:[a.jsx(T,{label:"Добавить страну",options:ed.countries.map(e=>({value:e.id,label:e.name})),selected:ew.countryIds,onChange:e=>ek(s=>({...s,countryIds:e})),disabled:0===ed.countries.length,fullWidth:!0}),a.jsx(n.z,{variant:"ghost",size:"sm",onClick:()=>eJ("countryIds"),disabled:0===ew.countryIds.length,className:"sm:w-auto w-full",children:"Очистить"})]}),a.jsx("div",{className:"flex flex-wrap gap-2",children:ew.countryIds.length>0?ew.countryIds.map(e=>{let s=ed.countries.find(s=>s.id===e);return s?(0,a.jsxs)(c.C,{variant:"secondary",className:"gap-1",children:[s.name,a.jsx("button",{type:"button",className:"ml-1 inline-flex h-4 w-4 items-center justify-center rounded-sm hover:text-destructive",onClick:()=>eW("countryIds",e),children:a.jsx(R.Z,{className:"h-3 w-3"})})]},`selected-country-${e}`):null}):a.jsx("span",{className:"text-xs text-muted-foreground",children:"Страны не выбраны"})}),(0,a.jsxs)("div",{className:"space-y-2 border-t pt-4",children:[a.jsx(f._,{className:"text-xs font-medium text-muted-foreground",children:"Добавить новую страну"}),(0,a.jsxs)("div",{className:"flex flex-col gap-2 sm:flex-row",children:[a.jsx(h.I,{value:ev.country,onChange:eG("country"),placeholder:"Название новой страны",className:"h-9"}),a.jsx(n.z,{size:"sm",onClick:()=>eK("country"),disabled:"country"===ey,children:"country"===ey?"Добавление...":"Добавить"})]})]})]}),(0,a.jsxs)("section",{className:"rounded-lg border bg-muted/10 p-4 space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-1",children:[a.jsx(f._,{className:"text-sm font-semibold",children:"Города"}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Выберите города. Сначала укажите страну — мы подберём связанные города автоматически."})]}),(0,a.jsxs)("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:gap-3",children:[a.jsx(T,{label:"Добавить город",options:eR,selected:ew.cityIds,onChange:e=>ek(s=>({...s,cityIds:e})),disabled:0===eR.length,fullWidth:!0}),a.jsx(n.z,{variant:"ghost",size:"sm",onClick:()=>eJ("cityIds"),disabled:0===ew.cityIds.length,className:"sm:w-auto w-full",children:"Очистить"})]}),a.jsx("div",{className:"flex flex-wrap gap-2",children:ew.cityIds.length>0?ew.cityIds.map(e=>{let s=eR.find(s=>s.value===e);return s?(0,a.jsxs)(c.C,{variant:"secondary",className:"gap-1",children:[s.label,a.jsx("button",{type:"button",className:"ml-1 inline-flex h-4 w-4 items-center justify-center rounded-sm hover:text-destructive",onClick:()=>eW("cityIds",e),children:a.jsx(R.Z,{className:"h-3 w-3"})})]},`selected-city-${e}`):null}):a.jsx("span",{className:"text-xs text-muted-foreground",children:"Города не выбраны"})}),(0,a.jsxs)("div",{className:"space-y-2 border-t pt-4",children:[a.jsx(f._,{className:"text-xs font-medium text-muted-foreground",children:"Добавить новый город"}),(0,a.jsxs)("div",{className:"flex flex-col gap-2 sm:flex-row",children:[a.jsx(h.I,{value:ev.city,onChange:eG("city"),placeholder:"Название нового города",className:"h-9",disabled:0===ew.countryIds.length}),a.jsx(n.z,{size:"sm",onClick:()=>eK("city"),disabled:0===ew.countryIds.length||"city"===ey,children:"city"===ey?"Добавление...":"Добавить"})]}),0===ew.countryIds.length&&a.jsx("p",{className:"text-xs text-muted-foreground",children:"Чтобы добавить город, сначала выберите страну."})]})]})]})]})}),(0,a.jsxs)("div",{className:"mt-6 flex flex-col items-end gap-2",children:[a.jsx(n.z,{onClick:eB,disabled:eg||em,variant:"outline",className:"w-full sm:w-56",children:eg?(0,a.jsxs)(a.Fragment,{children:[a.jsx(C,{className:"mr-2 h-4 w-4 animate-spin"}),"Регенерация..."]}):(0,a.jsxs)(a.Fragment,{children:[a.jsx(C,{className:"mr-2 h-4 w-4"}),"Регенерировать таксономию"]})}),a.jsx(n.z,{onClick:eX,disabled:e$||ep||em,className:"w-full sm:w-56",children:e$||ep?"Сохранение...":"Сохранить"})]}),(E?.link||E?.source)&&a.jsx("div",{className:"mt-6 pt-4 border-t",children:a.jsx(n.z,{variant:"outline",size:"sm",asChild:!0,children:(0,a.jsxs)("a",{href:E.link||E.source||"#",target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2",children:[a.jsx(D.Z,{className:"h-4 w-4"}),"Открыть источник"]})})})]})})]})})]})}},1677:(e,s,t)=>{"use strict";t.d(s,{aR:()=>R,OL:()=>T,le:()=>E,_T:()=>M,yT:()=>_,xo:()=>P,fY:()=>O,f$:()=>q});var a=t(326),r=t(7577),n=t(3095),i=t(8051),l=t(7956),c=t(2561),d=Symbol("radix.slottable"),o="AlertDialog",[m,u]=(0,n.b)(o,[l.p8]),x=(0,l.p8)(),h=e=>{let{__scopeAlertDialog:s,...t}=e,r=x(s);return(0,a.jsx)(l.fC,{...r,...t,modal:!0})};h.displayName=o,r.forwardRef((e,s)=>{let{__scopeAlertDialog:t,...r}=e,n=x(t);return(0,a.jsx)(l.xz,{...n,...r,ref:s})}).displayName="AlertDialogTrigger";var p=e=>{let{__scopeAlertDialog:s,...t}=e,r=x(s);return(0,a.jsx)(l.h_,{...r,...t})};p.displayName="AlertDialogPortal";var f=r.forwardRef((e,s)=>{let{__scopeAlertDialog:t,...r}=e,n=x(t);return(0,a.jsx)(l.aV,{...n,...r,ref:s})});f.displayName="AlertDialogOverlay";var g="AlertDialogContent",[j,y]=m(g),N=function(e){let s=({children:e})=>(0,a.jsx)(a.Fragment,{children:e});return s.displayName=`${e}.Slottable`,s.__radixId=d,s}("AlertDialogContent"),v=r.forwardRef((e,s)=>{let{__scopeAlertDialog:t,children:n,...d}=e,o=x(t),m=r.useRef(null),u=(0,i.e)(s,m),h=r.useRef(null);return(0,a.jsx)(l.jm,{contentName:g,titleName:b,docsSlug:"alert-dialog",children:(0,a.jsx)(j,{scope:t,cancelRef:h,children:(0,a.jsxs)(l.VY,{role:"alertdialog",...o,...d,ref:u,onOpenAutoFocus:(0,c.Mj)(d.onOpenAutoFocus,e=>{e.preventDefault(),h.current?.focus({preventScroll:!0})}),onPointerDownOutside:e=>e.preventDefault(),onInteractOutside:e=>e.preventDefault(),children:[(0,a.jsx)(N,{children:n}),(0,a.jsx)($,{contentRef:m})]})})})});v.displayName=g;var b="AlertDialogTitle",w=r.forwardRef((e,s)=>{let{__scopeAlertDialog:t,...r}=e,n=x(t);return(0,a.jsx)(l.Dx,{...n,...r,ref:s})});w.displayName=b;var k="AlertDialogDescription",C=r.forwardRef((e,s)=>{let{__scopeAlertDialog:t,...r}=e,n=x(t);return(0,a.jsx)(l.dk,{...n,...r,ref:s})});C.displayName=k;var S=r.forwardRef((e,s)=>{let{__scopeAlertDialog:t,...r}=e,n=x(t);return(0,a.jsx)(l.x8,{...n,...r,ref:s})});S.displayName="AlertDialogAction";var z="AlertDialogCancel",I=r.forwardRef((e,s)=>{let{__scopeAlertDialog:t,...r}=e,{cancelRef:n}=y(z,t),c=x(t),d=(0,i.e)(s,n);return(0,a.jsx)(l.x8,{...c,...r,ref:d})});I.displayName=z;var $=({contentRef:e})=>{let s=`\`${g}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${g}\` by passing a \`${k}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${g}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return r.useEffect(()=>{document.getElementById(e.current?.getAttribute("aria-describedby"))||console.warn(s)},[s,e]),null},A=t(7863),Z=t(772);let R=h,D=r.forwardRef(({className:e,...s},t)=>a.jsx(f,{className:(0,A.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...s,ref:t}));D.displayName=f.displayName;let M=r.forwardRef(({className:e,...s},t)=>(0,a.jsxs)(p,{children:[a.jsx(D,{}),a.jsx(v,{ref:t,className:(0,A.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...s})]}));M.displayName=v.displayName;let O=({className:e,...s})=>a.jsx("div",{className:(0,A.cn)("flex flex-col space-y-2 text-center sm:text-left",e),...s});O.displayName="AlertDialogHeader";let P=({className:e,...s})=>a.jsx("div",{className:(0,A.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...s});P.displayName="AlertDialogFooter";let q=r.forwardRef(({className:e,...s},t)=>a.jsx(w,{ref:t,className:(0,A.cn)("text-lg font-semibold",e),...s}));q.displayName=w.displayName;let _=r.forwardRef(({className:e,...s},t)=>a.jsx(C,{ref:t,className:(0,A.cn)("text-sm text-muted-foreground",e),...s}));_.displayName=C.displayName;let T=r.forwardRef(({className:e,...s},t)=>a.jsx(S,{ref:t,className:(0,A.cn)((0,Z.d)(),e),...s}));T.displayName=S.displayName;let E=r.forwardRef(({className:e,...s},t)=>a.jsx(I,{ref:t,className:(0,A.cn)((0,Z.d)({variant:"outline"}),"mt-2 sm:mt-0",e),...s}));E.displayName=I.displayName},567:(e,s,t)=>{"use strict";t.d(s,{C:()=>l});var a=t(326);t(7577);var r=t(9360),n=t(7863);let i=(0,r.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function l({className:e,variant:s,...t}){return a.jsx("div",{className:(0,n.cn)(i({variant:s}),e),...t})}},97:(e,s,t)=>{"use strict";t.d(s,{$F:()=>o,AW:()=>m,Ju:()=>h,VD:()=>p,Xi:()=>u,bO:()=>x,h_:()=>d});var a=t(326),r=t(7577),n=t(5432),i=t(6562),l=t(799),c=t(7863);let d=n.fC,o=n.xz;n.ZA,n.Uv,n.Tr,n.Ee,r.forwardRef(({className:e,inset:s,children:t,...r},l)=>(0,a.jsxs)(n.fF,{ref:l,className:(0,c.cn)("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",s&&"pl-8",e),...r,children:[t,a.jsx(i.Z,{className:"ml-auto h-4 w-4"})]})).displayName=n.fF.displayName,r.forwardRef(({className:e,...s},t)=>a.jsx(n.tu,{ref:t,className:(0,c.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...s})).displayName=n.tu.displayName;let m=r.forwardRef(({className:e,sideOffset:s=4,...t},r)=>a.jsx(n.Uv,{children:a.jsx(n.VY,{ref:r,sideOffset:s,className:(0,c.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...t})}));m.displayName=n.VY.displayName;let u=r.forwardRef(({className:e,inset:s,...t},r)=>a.jsx(n.ck,{ref:r,className:(0,c.cn)("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s&&"pl-8",e),...t}));u.displayName=n.ck.displayName;let x=r.forwardRef(({className:e,children:s,checked:t,...r},i)=>(0,a.jsxs)(n.oC,{ref:i,className:(0,c.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),checked:t,...r,children:[a.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:a.jsx(n.wU,{children:a.jsx(l.Z,{className:"h-4 w-4"})})}),s]}));x.displayName=n.oC.displayName,r.forwardRef(({className:e,children:s,...t},r)=>(0,a.jsxs)(n.Rk,{ref:r,className:(0,c.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...t,children:[a.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:a.jsx(n.wU,{children:a.jsx("span",{className:"h-2 w-2 rounded-full bg-current"})})}),s]})).displayName=n.Rk.displayName;let h=r.forwardRef(({className:e,inset:s,...t},r)=>a.jsx(n.__,{ref:r,className:(0,c.cn)("px-2 py-1.5 text-sm font-semibold",s&&"pl-8",e),...t}));h.displayName=n.__.displayName;let p=r.forwardRef(({className:e,...s},t)=>a.jsx(n.Z0,{ref:t,className:(0,c.cn)("-mx-1 my-1 h-px bg-muted",e),...s}));p.displayName=n.Z0.displayName},3427:(e,s,t)=>{"use strict";t.d(s,{mQ:()=>$,nU:()=>R,dr:()=>A,SP:()=>Z});var a=t(326),r=t(7577),n=t(2561),i=t(3095),l=t(5594),c=t(9815),d=t(7335),o=t(7124),m=t(2067),u=t(8957),x="Tabs",[h,p]=(0,i.b)(x,[l.Pc]),f=(0,l.Pc)(),[g,j]=h(x),y=r.forwardRef((e,s)=>{let{__scopeTabs:t,value:r,onValueChange:n,defaultValue:i,orientation:l="horizontal",dir:c,activationMode:h="automatic",...p}=e,f=(0,o.gm)(c),[j,y]=(0,m.T)({prop:r,onChange:n,defaultProp:i??"",caller:x});return(0,a.jsx)(g,{scope:t,baseId:(0,u.M)(),value:j,onValueChange:y,orientation:l,dir:f,activationMode:h,children:(0,a.jsx)(d.WV.div,{dir:f,"data-orientation":l,...p,ref:s})})});y.displayName=x;var N="TabsList",v=r.forwardRef((e,s)=>{let{__scopeTabs:t,loop:r=!0,...n}=e,i=j(N,t),c=f(t);return(0,a.jsx)(l.fC,{asChild:!0,...c,orientation:i.orientation,dir:i.dir,loop:r,children:(0,a.jsx)(d.WV.div,{role:"tablist","aria-orientation":i.orientation,...n,ref:s})})});v.displayName=N;var b="TabsTrigger",w=r.forwardRef((e,s)=>{let{__scopeTabs:t,value:r,disabled:i=!1,...c}=e,o=j(b,t),m=f(t),u=S(o.baseId,r),x=z(o.baseId,r),h=r===o.value;return(0,a.jsx)(l.ck,{asChild:!0,...m,focusable:!i,active:h,children:(0,a.jsx)(d.WV.button,{type:"button",role:"tab","aria-selected":h,"aria-controls":x,"data-state":h?"active":"inactive","data-disabled":i?"":void 0,disabled:i,id:u,...c,ref:s,onMouseDown:(0,n.Mj)(e.onMouseDown,e=>{i||0!==e.button||!1!==e.ctrlKey?e.preventDefault():o.onValueChange(r)}),onKeyDown:(0,n.Mj)(e.onKeyDown,e=>{[" ","Enter"].includes(e.key)&&o.onValueChange(r)}),onFocus:(0,n.Mj)(e.onFocus,()=>{let e="manual"!==o.activationMode;h||i||!e||o.onValueChange(r)})})})});w.displayName=b;var k="TabsContent",C=r.forwardRef((e,s)=>{let{__scopeTabs:t,value:n,forceMount:i,children:l,...o}=e,m=j(k,t),u=S(m.baseId,n),x=z(m.baseId,n),h=n===m.value,p=r.useRef(h);return r.useEffect(()=>{let e=requestAnimationFrame(()=>p.current=!1);return()=>cancelAnimationFrame(e)},[]),(0,a.jsx)(c.z,{present:i||h,children:({present:t})=>(0,a.jsx)(d.WV.div,{"data-state":h?"active":"inactive","data-orientation":m.orientation,role:"tabpanel","aria-labelledby":u,hidden:!t,id:x,tabIndex:0,...o,ref:s,style:{...e.style,animationDuration:p.current?"0s":void 0},children:t&&l})})});function S(e,s){return`${e}-trigger-${s}`}function z(e,s){return`${e}-content-${s}`}C.displayName=k;var I=t(7863);let $=y,A=r.forwardRef(({className:e,...s},t)=>a.jsx(v,{ref:t,className:(0,I.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",e),...s}));A.displayName=v.displayName;let Z=r.forwardRef(({className:e,...s},t)=>a.jsx(w,{ref:t,className:(0,I.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",e),...s}));Z.displayName=w.displayName;let R=r.forwardRef(({className:e,...s},t)=>a.jsx(C,{ref:t,className:(0,I.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...s}));R.displayName=C.displayName},7673:(e,s,t)=>{"use strict";t.d(s,{g:()=>i});var a=t(326),r=t(7577),n=t(7863);let i=r.forwardRef(({className:e,...s},t)=>a.jsx("textarea",{className:(0,n.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:t,...s}));i.displayName="Textarea"},2227:(e,s,t)=>{"use strict";t.r(s),t.d(s,{$$typeof:()=>i,__esModule:()=>n,default:()=>l});var a=t(8570);let r=(0,a.createProxy)(String.raw`/Users/macbookpro/Desktop/syndicateadmin/app/admin/materials/page.tsx`),{__esModule:n,$$typeof:i}=r;r.default;let l=(0,a.createProxy)(String.raw`/Users/macbookpro/Desktop/syndicateadmin/app/admin/materials/page.tsx#default`)},770:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});let a=(0,t(7926).Z)("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},8120:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});let a=(0,t(7926).Z)("Archive",[["rect",{width:"20",height:"5",x:"2",y:"4",rx:"2",key:"uhwcea"}],["path",{d:"M4 9v9a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9",key:"shkvi4"}],["path",{d:"M10 13h4",key:"ytezjc"}]])},4674:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});let a=(0,t(7926).Z)("CheckCircle2",[["path",{d:"M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10z",key:"14v8dr"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]])},6694:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});let a=(0,t(7926).Z)("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]])},6840:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});let a=(0,t(7926).Z)("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]])},4459:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});let a=(0,t(7926).Z)("ChevronsLeft",[["path",{d:"m11 17-5-5 5-5",key:"13zhaf"}],["path",{d:"m18 17-5-5 5-5",key:"h8a8et"}]])},3495:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});let a=(0,t(7926).Z)("ChevronsRight",[["path",{d:"m6 17 5-5-5-5",key:"xnjwq"}],["path",{d:"m13 17 5-5-5-5",key:"17xmmf"}]])},2959:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});let a=(0,t(7926).Z)("ExternalLink",[["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}],["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["line",{x1:"10",x2:"21",y1:"14",y2:"3",key:"18c3s4"}]])},9492:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});let a=(0,t(7926).Z)("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])}};var s=require("../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),a=s.X(0,[948,283,896,434,631,432,392,627],()=>t(3934));module.exports=a})();