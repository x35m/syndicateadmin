(()=>{var e={};e.id=3227,e.ids=[3227],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},5900:e=>{"use strict";e.exports=require("pg")},9261:e=>{"use strict";e.exports=require("postcss")},2081:e=>{"use strict";e.exports=require("child_process")},6113:e=>{"use strict";e.exports=require("crypto")},2361:e=>{"use strict";e.exports=require("events")},3685:e=>{"use strict";e.exports=require("http")},5687:e=>{"use strict";e.exports=require("https")},1017:e=>{"use strict";e.exports=require("path")},5477:e=>{"use strict";e.exports=require("punycode")},2781:e=>{"use strict";e.exports=require("stream")},7310:e=>{"use strict";e.exports=require("url")},9796:e=>{"use strict";e.exports=require("zlib")},3934:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>n.a,__next_app__:()=>x,originalPathname:()=>m,pages:()=>o,routeModule:()=>u,tree:()=>d}),t(2227),t(596),t(7489),t(5866);var a=t(3191),r=t(8716),l=t(7922),n=t.n(l),i=t(5231),c={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>i[e]);t.d(s,c);let d=["",{children:["admin",{children:["materials",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,2227)),"/Users/macbookpro/Desktop/syndicateadmin/app/admin/materials/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,596)),"/Users/macbookpro/Desktop/syndicateadmin/app/admin/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,7489)),"/Users/macbookpro/Desktop/syndicateadmin/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,5866,23)),"next/dist/client/components/not-found-error"]}],o=["/Users/macbookpro/Desktop/syndicateadmin/app/admin/materials/page.tsx"],m="/admin/materials/page",x={require:t,loadChunk:()=>Promise.resolve()},u=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/admin/materials/page",pathname:"/admin/materials",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},359:(e,s,t)=>{Promise.resolve().then(t.bind(t,3752))},3752:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>D});var a=t(326),r=t(7577),l=t(772),n=t(2643),i=t(5940),c=t(567),d=t(2288),o=t(1677),m=t(3427),x=t(3313),u=t(5304),h=t(4432),p=t(7673),g=t(1048),f=t(6694),j=t(9492),y=t(770),N=t(4674),b=t(7926);let v=(0,b.Z)("PauseCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"10",x2:"10",y1:"15",y2:"9",key:"c1nkhi"}],["line",{x1:"14",x2:"14",y1:"15",y2:"9",key:"h65svq"}]]),w=(0,b.Z)("StopCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["rect",{width:"6",height:"6",x:"9",y:"9",key:"1wrtvo"}]]),k=(0,b.Z)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["polyline",{points:"22 4 12 14.01 9 11.01",key:"6xbx8j"}]]),C=(0,b.Z)("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]);var S=t(8120),z=t(3183),I=t(4459),$=t(6840),Z=t(6562),A=t(3495),q=t(380),M=t(2959),O=t(3796),P=t(5999),_=t(97);let E={search:"",categories:[],countries:[],cities:[],feeds:[]},T={"generate-summary":{label:"Генерация саммари",successMessage:"Генерация завершена успешно"},published:{label:"Публикация",successMessage:"Публикация завершена успешно"},archived:{label:"Архивирование",successMessage:"Архивирование завершено"},delete:{label:"Удаление",successMessage:"Удаление завершено"}};function R({label:e,options:s,selected:t,onChange:n,disabled:i,fullWidth:d,maxSelected:o}){let[m,x]=(0,r.useState)(""),u=e=>{if(t.includes(e))n(t.filter(s=>s!==e));else if(o&&o>0){if(1===o)n([e]);else{let s=[...t,e],a=s.length-o;a>0&&s.splice(0,a),n(s)}}else n([...t,e])},p=(0,r.useMemo)(()=>{let e=m.trim().toLowerCase();return e?s.filter(s=>s.label.toLowerCase().includes(e)):s},[s,m]);return(0,a.jsxs)(_.h_,{onOpenChange:e=>!e&&x(""),children:[a.jsx(_.$F,{asChild:!0,disabled:i,children:(0,a.jsxs)(l.z,{variant:"outline",size:"sm",className:`${d?"w-full":"min-w-[180px]"} justify-between`,children:[(0,a.jsxs)("span",{className:"flex items-center gap-2 text-sm",children:[a.jsx("span",{children:e}),t.length>0&&a.jsx(c.C,{variant:"secondary",className:"px-1 text-xs font-medium",children:t.length})]}),a.jsx(f.Z,{className:"h-3 w-3 text-muted-foreground"})]})}),(0,a.jsxs)(_.AW,{align:"start",className:`${d?"w-80":"w-64"} max-h-64 overflow-y-auto`,children:[a.jsx(_.Ju,{children:e}),a.jsx(_.VD,{}),a.jsx("div",{className:"p-1",children:a.jsx(h.I,{placeholder:"Поиск...",value:m,onChange:e=>x(e.target.value),className:"h-8"})}),a.jsx(_.VD,{}),0===p.length?a.jsx("div",{className:"px-2 py-1.5 text-xs text-muted-foreground",children:"Ничего не найдено"}):p.map(e=>a.jsx(_.bO,{checked:t.includes(e.value),onCheckedChange:()=>u(e.value),children:e.label},String(e.value)))]})]})}function D(){let[e,s]=(0,r.useState)([]),[t,f]=(0,r.useState)(!0),[b,_]=(0,r.useState)("all"),[D,L]=(0,r.useState)(null),[F,U]=(0,r.useState)(!1),[V,H]=(0,r.useState)(!1),[J,Y]=(0,r.useState)(new Set),[W,G]=(0,r.useState)(null),X=(0,r.useRef)(!1),[B,K]=(0,r.useState)(null),[Q,ee]=(0,r.useState)({total:0,new:0,processed:0,published:0,archived:0}),[es,et]=(0,r.useState)(1),[ea,er]=(0,r.useState)(50),[el,en]=(0,r.useState)(1),[ei,ec]=(0,r.useState)(0),[ed,eo]=(0,r.useState)({categories:[],countries:[]}),[em,ex]=(0,r.useState)(!1),[eu,eh]=(0,r.useState)(E),[ep,eg]=(0,r.useState)(!1),[ef,ej]=(0,r.useState)(!1),[ey,eN]=(0,r.useState)(null),[eb,ev]=(0,r.useState)({category:"",country:"",city:""}),[ew,ek]=(0,r.useState)({categoryIds:[],countryIds:[],cityIds:[]}),[eC,eS]=(0,r.useState)(""),[ez,eI]=(0,r.useState)(""),[e$,eZ]=(0,r.useState)(!1),eA=(0,r.useMemo)(()=>{let s=new Set;return e.forEach(e=>{let t=e.feedName||e.source;t&&s.add(t)}),Array.from(s).sort((e,s)=>e.localeCompare(s,"ru"))},[e]),eq=(0,r.useMemo)(()=>{let e=[];return ed.countries.forEach(s=>{s.cities.forEach(t=>{e.push({value:t.id,label:`${t.name} — ${s.name}`})})}),e.sort((e,s)=>e.label.localeCompare(s.label,"ru"))},[ed.countries]),eM=(0,r.useMemo)(()=>!!D&&(eC!==(D.summary??"")||ez!==(D.metaDescription??"")),[D,eC,ez]),eO=(0,r.useMemo)(()=>eu.search.trim().length>0||eu.categories.length>0||eu.countries.length>0||eu.cities.length>0||eu.feeds.length>0,[eu]),eP=(0,r.useCallback)(async(e="all",t=es,a={})=>{let r=a.silent??!1;r||f(!0);try{let a=new URLSearchParams;a.set("status",e),a.set("page",t.toString()),a.set("pageSize",ea.toString()),eu.search&&a.set("search",eu.search),eu.categories.length>0&&a.set("categoryIds",eu.categories.join(",")),eu.countries.length>0&&a.set("countryIds",eu.countries.join(",")),eu.cities.length>0&&a.set("cityIds",eu.cities.join(",")),eu.feeds.length>0&&a.set("feedNames",eu.feeds.join(","));let r=await fetch(`/api/materials?${a.toString()}`),l=await r.json();l.success&&(s(l.data),l.pagination&&(en(l.pagination.totalPages),ec(l.pagination.total),et(l.pagination.page)),ee(l.stats||{total:0,new:0,processed:0,published:0,archived:0}))}catch(e){console.error("Error fetching materials:",e)}finally{r||f(!1)}},[eu,ea,es]),e_=(0,r.useCallback)(async(e,s)=>{let t=await fetch("/api/materials",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e,...s})}),a=await t.json();if(!t.ok||!a.success)throw Error(a.error||"Не удалось обновить материал")},[]),eE=async()=>{try{ex(!0);let e=await fetch("/api/taxonomy"),s=await e.json();s.success?eo({categories:s.categories??[],countries:s.countries??[]}):P.Am.error(s.error||"Не удалось загрузить таксономию")}catch(e){console.error("Error fetching taxonomy:",e),P.Am.error("Не удалось загрузить таксономию")}finally{ex(!1)}},eT=e=>{if(W?.running){P.Am.info("Дождитесь завершения текущего процесса");return}if(0===J.size){P.Am.warning("Выберите материалы для обработки");return}K(e)},eR=(0,r.useCallback)(async()=>{if(!B)return;let s=Array.from(J);if(0===s.length){K(null),P.Am.warning("Нет выбранных материалов для обработки");return}K(null);let t=T[B];G({action:B,label:t.label,total:s.length,completed:0,success:0,failed:0,running:!0,stopRequested:!1,message:"Запуск...",errors:[]}),X.current=!1;let a=new Map(e.map(e=>[e.id,e])),r=[],l=0,n=0,i=0,c=e=>{G(s=>s?{...s,...e}:s)},d=e=>{c({completed:i,success:l,failed:n,message:e})},o=async(e,s)=>{await e_(e,s)};try{if("generate-summary"===B){for(let e of s){if(X.current){c({message:"Остановка запрошена. Завершаем процесс..."});break}let t=a.get(e);d(`Генерация саммари: ${t?.title??e}`);try{let s=await fetch("/api/materials/generate-summary",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({materialId:e})}),t=await s.json();if(!s.ok||!t.success)throw Error(t.error||"Не удалось сгенерировать саммари");l++}catch(s){n++,r.push({id:e,title:a.get(e)?.title??e,message:s instanceof Error?s.message:String(s)})}i++,d(`Обработано ${i}/${s.length}`)}l>0&&await eE()}else if("delete"===B)for(let e of s){if(X.current){c({message:"Остановка запрошена. Завершаем процесс..."});break}let t=a.get(e);d(`Удаление: ${t?.title??e}`);try{let s=await fetch(`/api/materials?id=${e}`,{method:"DELETE"});if(!s.ok){let e=await s.json().catch(()=>null);throw Error(e?.error||"Не удалось удалить материал")}l++}catch(s){n++,r.push({id:e,title:t?.title??e,message:s instanceof Error?s.message:String(s)})}i++,d(`Обработано ${i}/${s.length}`)}else if("archived"===B)for(let e of s){if(X.current){c({message:"Остановка запрошена. Завершаем процесс..."});break}let t=a.get(e);d(`Архивирование: ${t?.title??e}`);try{await o(e,{status:"archived",published:!1}),l++}catch(s){n++,r.push({id:e,title:t?.title??e,message:s instanceof Error?s.message:String(s)})}i++,d(`Обработано ${i}/${s.length}`)}else if("published"===B)for(let e of s){if(X.current){c({message:"Остановка запрошена. Завершаем процесс..."});break}let t=a.get(e);if(d(`Публикация: ${t?.title??e}`),!t){n++,r.push({id:e,title:e,message:"Материал не найден в текущем списке"}),i++,d(`Обработано ${i}/${s.length}`);continue}if(!t.summary||0===t.summary.trim().length){n++,r.push({id:e,title:t.title,message:"У материала отсутствует саммари, публикация невозможна"}),i++,d(`Обработано ${i}/${s.length}`);continue}try{await o(e,{published:!0}),l++}catch(s){n++,r.push({id:e,title:t.title,message:s instanceof Error?s.message:String(s)})}i++,d(`Обработано ${i}/${s.length}`)}}catch(e){r.push({id:"system",title:"Системная ошибка",message:e instanceof Error?e.message:String(e)})}finally{await eP(b,es,{silent:!0}),Y(new Set);let e=X.current;X.current=!1;let a=s.length,d=i,o=l,m=n,x="";x=e&&d<a?`Процесс остановлен пользователем. Обработано ${d} из ${a}.`:0===m?`${t.successMessage}. Обработано ${o} из ${a}.`:0===o?`Не удалось выполнить действие. Ошибок: ${m}.`:`Выполнено с ошибками: успешно ${o}, ошибок ${m}.`,c({running:!1,stopRequested:e,completed:d,success:o,failed:m,message:x,errors:r}),e&&d<a?(0,P.Am)(x):0===m?P.Am.success(x):P.Am.warning(x)}},[B,J,e,b,es,eP,eE,e_]),eD=async e=>{_(e),eh(E),await eP(e),Y(new Set),et(1)},eL=e=>{L(e),ek({categoryIds:e.categories?.length?[e.categories[0].id]:[],countryIds:e.countries?.map(e=>e.id)??[],cityIds:e.cities?.map(e=>e.id)??[]}),eS(e.summary??""),eI(e.metaDescription??""),H(!1),U(!0)},eF=(es-1)*ea,eU=eF+e.length,eV=e=>{et(Math.max(1,Math.min(e,el)))},eH=e=>{er(e),et(1)},eJ=e=>{if(W?.running)return;let s=new Set(J);s.has(e)?s.delete(e):s.add(e),Y(s)},eY=(e,s)=>{ek(t=>{let a=new Set(t[e]);return a.delete(s),{...t,[e]:Array.from(a)}})},eW=e=>{ek(s=>({...s,[e]:[]}))},eG=e=>s=>{ev(t=>({...t,[e]:s.target.value}))},eX=async e=>{let s=eb[e];if(!s.trim()){P.Am.warning("Введите название");return}if("city"===e){if(0===ew.countryIds.length){P.Am.warning("Выберите хотя бы одну страну перед добавлением города");return}let t=ew.countryIds[0];try{eN(e);let a=await fetch("/api/taxonomy",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:e,name:s,countryId:t})}),r=await a.json();if(!r.success){P.Am.error(r.error||"Не удалось создать элемент");return}await eE(),ek(e=>({...e,cityIds:Array.from(new Set([...e.cityIds,r.data.id]))})),ev(s=>({...s,[e]:""})),P.Am.success("Элемент создан")}catch(e){console.error("Error creating taxonomy item:",e),P.Am.error("Ошибка при создании элемента")}finally{eN(null)}return}try{eN(e);let t=await fetch("/api/taxonomy",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:e,name:s})}),a=await t.json();if(!a.success){P.Am.error(a.error||"Не удалось создать элемент");return}switch(await eE(),e){case"category":ek(e=>({...e,categoryIds:[a.data.id]}));break;case"country":ek(e=>({...e,countryIds:Array.from(new Set([...e.countryIds,a.data.id]))}))}ev(s=>({...s,[e]:""})),P.Am.success("Элемент создан")}catch(e){console.error("Error creating taxonomy item:",e),P.Am.error("Ошибка при создании элемента")}finally{eN(null)}},eB=async()=>{if(D)try{eZ(!0),eg(!0);let e=[];eM&&e.push(e_(D.id,{summary:eC,metaDescription:ez})),e.push(fetch("/api/materials/taxonomy",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({materialId:D.id,categoryIds:ew.categoryIds.slice(0,1),countryIds:ew.countryIds,cityIds:ew.cityIds})}).then(async e=>{let s=await e.json();if(!e.ok||!s.success)throw Error(s.error||"Не удалось сохранить таксономию");return s.data}));let[,t]=await Promise.all(e);t?(s(e=>e.map(e=>e.id===t.id?t:e)),L({...t,summary:eC,metaDescription:ez}),ek({categoryIds:t.categories?.length?[t.categories[0].id]:[],countryIds:t.countries?.map(e=>e.id)??[],cityIds:t.cities?.map(e=>e.id)??[]})):L(e=>e&&e.id===D.id?{...e,summary:eC,metaDescription:ez}:e),await eP(b,es,{silent:!0}),P.Am.success("Материал сохранён")}catch(e){console.error("Error saving material:",e),P.Am.error("Не удалось сохранить материал")}finally{eZ(!1),eg(!1)}},eK=async()=>{if(D)try{ej(!0);let e=await fetch("/api/materials/regenerate-taxonomy",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({materialId:D.id})}),t=await e.json();if(!e.ok)throw Error(t.error||"Ошибка при регенерации таксономии");if(t.success&&t.data?.material){let e=t.data.material;L(e),eS(e.summary??""),eI(e.metaDescription??""),ek({categoryIds:e.categories?.length?[e.categories[0].id]:[],countryIds:e.countries?.map(e=>e.id)??[],cityIds:e.cities?.map(e=>e.id)??[]}),s(s=>s.map(s=>s.id===e.id?e:s)),P.Am.success("Таксономия успешно обновлена"),await eE()}}catch(e){console.error("Error regenerating taxonomy:",e),P.Am.error(e.message||"Ошибка при регенерации таксономии")}finally{ej(!1)}},eQ=e=>{switch(e){case"new":return a.jsx(c.C,{variant:"default",children:"Новый"});case"processed":return a.jsx(c.C,{variant:"secondary",className:"bg-green-500/10 text-green-700 dark:text-green-400",children:"Обработан"});case"published":return a.jsx(c.C,{variant:"secondary",className:"bg-blue-500/10 text-blue-700 dark:text-blue-400",children:"Опубликован"});case"archived":return a.jsx(c.C,{variant:"outline",children:"Архив"});default:return a.jsx(c.C,{children:e})}},e0=e=>{let s=new Date(e),t=String(s.getDate()).padStart(2,"0"),a=String(s.getMonth()+1).padStart(2,"0"),r=String(s.getFullYear()).slice(-2),l=String(s.getHours()).padStart(2,"0"),n=String(s.getMinutes()).padStart(2,"0");return`${t}.${a}.${r} ${l}:${n}`},e2=(()=>{let e=J.size;switch(B){case"published":return{title:"Опубликовать материалы",description:`Вы уверены, что хотите опубликовать ${e} материал(ов)?`,actionText:"Опубликовать",variant:"default"};case"archived":return{title:"Архивировать материалы",description:`Вы уверены, что хотите архивировать ${e} материал(ов)?`,actionText:"Архивировать",variant:"default"};case"delete":return{title:"Удалить материалы",description:`Вы уверены, что хотите удалить ${e} материал(ов)? Это действие необратимо!`,actionText:"Удалить",variant:"destructive"};case"generate-summary":return{title:"Генерация саммари",description:1===e?"Сгенерировать саммари для этого материала?":`Сгенерировать саммари для ${e} материалов?`,actionText:"Сгенерировать",variant:"default"};default:return null}})();return(0,a.jsxs)(a.Fragment,{children:[a.jsx(O.P,{}),a.jsx("div",{className:"min-h-screen bg-background p-8",children:(0,a.jsxs)("div",{className:"container space-y-6",children:[a.jsx("div",{className:"flex justify-between items-center",children:a.jsx(m.mQ,{value:b,onValueChange:eD,children:(0,a.jsxs)(m.dr,{children:[(0,a.jsxs)(m.SP,{value:"all",children:["Все ",Q.total>0&&(0,a.jsxs)("span",{className:"ml-1.5 text-xs",children:["(",Q.total,")"]})]}),(0,a.jsxs)(m.SP,{value:"new",children:["Новые ",Q.new>0&&(0,a.jsxs)("span",{className:"ml-1.5 text-xs",children:["(",Q.new,")"]})]}),(0,a.jsxs)(m.SP,{value:"processed",children:["Обработанные ",Q.processed>0&&(0,a.jsxs)("span",{className:"ml-1.5 text-xs",children:["(",Q.processed,")"]})]}),(0,a.jsxs)(m.SP,{value:"published",children:["Опубликованные ",Q.published>0&&(0,a.jsxs)("span",{className:"ml-1.5 text-xs",children:["(",Q.published,")"]})]}),(0,a.jsxs)(m.SP,{value:"archived",children:["Архив ",Q.archived>0&&(0,a.jsxs)("span",{className:"ml-1.5 text-xs",children:["(",Q.archived,")"]})]})]})})}),W?a.jsx("div",{className:"fixed bottom-8 left-1/2 -translate-x-1/2 z-50 animate-in slide-in-from-bottom-4 fade-in duration-300 w-[min(90vw,600px)]",children:a.jsx(n.Zb,{className:"border-primary shadow-2xl",children:(0,a.jsxs)(n.aY,{className:"py-4 px-6 space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,a.jsxs)("div",{children:[a.jsx("p",{className:"text-sm font-semibold",children:W.label}),a.jsx("p",{className:"text-xs text-muted-foreground",children:W.message}),(0,a.jsxs)("p",{className:"mt-2 text-xs text-muted-foreground",children:["Выполнено ",W.completed," из ",W.total,". Успешно ",W.success,", ошибок ",W.failed,"."]})]}),a.jsx("div",{className:"flex items-center justify-center rounded-full border bg-background p-2",children:W.running?a.jsx(j.Z,{className:"h-4 w-4 animate-spin text-primary"}):W.failed>0?a.jsx(y.Z,{className:"h-4 w-4 text-amber-500"}):a.jsx(N.Z,{className:"h-4 w-4 text-green-500"})})]}),a.jsx("div",{className:"h-2 w-full rounded-full bg-muted",children:a.jsx("div",{className:"h-2 rounded-full bg-primary transition-all",style:{width:`${W.total>0?Math.min(100,Math.round(W.completed/W.total*100)):0}%`}})}),W.errors.length>0&&(0,a.jsxs)("div",{className:"max-h-32 overflow-y-auto rounded-md border border-border/50 bg-muted/30 p-3 text-xs",children:[a.jsx("p",{className:"mb-2 font-semibold text-foreground",children:"Ошибки:"}),a.jsx("div",{className:"space-y-2",children:W.errors.map(e=>(0,a.jsxs)("div",{className:"space-y-1",children:[a.jsx("p",{className:"font-medium text-foreground break-words",children:e.title}),a.jsx("p",{className:"text-muted-foreground break-words",children:e.message})]},`${e.id}-${e.message}`))})]}),(0,a.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[a.jsx(l.z,{variant:"outline",size:"sm",onClick:()=>{W&&W.running&&!W.stopRequested&&(X.current=!0,G(e=>e?{...e,stopRequested:!0,message:"Остановка запрошена. Завершаем текущий элемент..."}:e))},disabled:!W.running||W.stopRequested,className:"flex items-center gap-2",children:W.stopRequested?(0,a.jsxs)(a.Fragment,{children:[a.jsx(v,{className:"h-4 w-4"}),"Остановка..."]}):W.running?(0,a.jsxs)(a.Fragment,{children:[a.jsx(w,{className:"h-4 w-4"}),"Остановить"]}):(0,a.jsxs)(a.Fragment,{children:[a.jsx(w,{className:"h-4 w-4"}),"Остановлено"]})}),a.jsx(l.z,{size:"sm",onClick:()=>{W&&(!W.running||W.stopRequested)&&(G(null),Y(new Set))},disabled:W.running,children:"Закрыть"})]})]})})}):J.size>0&&a.jsx("div",{className:"fixed bottom-8 left-1/2 -translate-x-1/2 z-50 animate-in slide-in-from-bottom-4 fade-in duration-300",children:a.jsx(n.Zb,{className:"border-primary shadow-2xl",children:a.jsx(n.aY,{className:"py-4 px-6",children:(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)("span",{className:"text-sm font-medium",children:["Выбрано: ",a.jsx("span",{className:"text-primary font-bold",children:J.size})," материал(ов)"]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(l.z,{size:"sm",variant:"default",onClick:()=>eT("published"),children:[a.jsx(k,{className:"mr-2 h-4 w-4"}),"Опубликовать"]}),(0,a.jsxs)(l.z,{size:"sm",variant:"secondary",onClick:()=>eT("generate-summary"),children:[a.jsx(C,{className:"mr-2 h-4 w-4"}),"Саммари"]}),(0,a.jsxs)(l.z,{size:"sm",variant:"outline",onClick:()=>eT("archived"),children:[a.jsx(S.Z,{className:"mr-2 h-4 w-4"}),"Архивировать"]}),(0,a.jsxs)(l.z,{size:"sm",variant:"destructive",onClick:()=>eT("delete"),children:[a.jsx(z.Z,{className:"mr-2 h-4 w-4"}),"Удалить"]})]}),a.jsx(l.z,{size:"sm",variant:"ghost",onClick:()=>Y(new Set),children:"Отменить"})]})})})}),(0,a.jsxs)(n.Zb,{children:[a.jsx(n.Ol,{children:(0,a.jsxs)(n.ll,{children:["Материалы (",ei,")"]})}),(0,a.jsxs)(n.aY,{children:[(0,a.jsxs)("div",{className:"mb-4 flex flex-col gap-3 lg:flex-row lg:items-center lg:justify-between",children:[(0,a.jsxs)("div",{className:"flex flex-wrap gap-2",children:[a.jsx(h.I,{placeholder:"Поиск…",value:eu.search,onChange:e=>eh(s=>({...s,search:e.target.value})),className:"h-9 w-full sm:w-64"}),a.jsx(R,{label:"Категории",options:ed.categories.map(e=>({value:e.id,label:e.isHidden?`${e.name} (скрыта)`:e.name})),selected:eu.categories,onChange:e=>eh(s=>({...s,categories:e})),disabled:0===ed.categories.length}),a.jsx(R,{label:"Страны",options:ed.countries.map(e=>({value:e.id,label:e.name})),selected:eu.countries,onChange:e=>eh(s=>({...s,countries:e})),disabled:0===ed.countries.length}),a.jsx(R,{label:"Города",options:eq,selected:eu.cities,onChange:e=>eh(s=>({...s,cities:e})),disabled:0===eq.length}),a.jsx(R,{label:"Источники",options:eA.map(e=>({value:e,label:e})),selected:eu.feeds,onChange:e=>eh(s=>({...s,feeds:e})),disabled:0===eA.length})]}),a.jsx("div",{className:"flex flex-wrap items-center gap-2",children:a.jsx(l.z,{variant:"ghost",size:"sm",onClick:()=>eh(E),disabled:!eO,children:"Сбросить фильтры"})})]}),!t&&e.length>0&&(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4 pb-4 border-b",children:[a.jsx("div",{className:"flex items-center gap-2",children:(0,a.jsxs)("span",{className:"text-sm text-muted-foreground",children:["Показано ",0===e.length?0:eF+1,"-",eU," из ",ei]})}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-sm text-muted-foreground",children:"На странице:"}),a.jsx("div",{className:"flex gap-1",children:[25,50,100,200].map(e=>a.jsx(l.z,{variant:ea===e?"default":"outline",size:"sm",onClick:()=>eH(e),className:"h-8 w-12",children:e},e))})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[a.jsx(l.z,{variant:"outline",size:"sm",onClick:()=>eV(1),disabled:1===es,className:"h-8 w-8 p-0",title:"Первая страница",children:a.jsx(I.Z,{className:"h-4 w-4"})}),a.jsx(l.z,{variant:"outline",size:"sm",onClick:()=>eV(es-1),disabled:1===es,className:"h-8 w-8 p-0",title:"Предыдущая страница",children:a.jsx($.Z,{className:"h-4 w-4"})}),(0,a.jsxs)("div",{className:"flex items-center gap-1 px-2",children:[a.jsx("span",{className:"text-sm font-medium",children:es}),a.jsx("span",{className:"text-sm text-muted-foreground",children:"из"}),a.jsx("span",{className:"text-sm font-medium",children:el})]}),a.jsx(l.z,{variant:"outline",size:"sm",onClick:()=>eV(es+1),disabled:es===el,className:"h-8 w-8 p-0",title:"Следующая страница",children:a.jsx(Z.Z,{className:"h-4 w-4"})}),a.jsx(l.z,{variant:"outline",size:"sm",onClick:()=>eV(el),disabled:es===el,className:"h-8 w-8 p-0",title:"Последняя страница",children:a.jsx(A.Z,{className:"h-4 w-4"})})]})]})]}),t?a.jsx("div",{className:"space-y-2",children:Array.from({length:10}).map((e,s)=>(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[a.jsx(u.O,{className:"h-12 w-12"}),a.jsx(u.O,{className:"h-16 w-16 rounded"}),(0,a.jsxs)("div",{className:"flex-1 space-y-2",children:[a.jsx(u.O,{className:"h-4 w-full"}),a.jsx(u.O,{className:"h-4 w-3/4"})]}),a.jsx(u.O,{className:"h-8 w-24"}),a.jsx(u.O,{className:"h-8 w-20"})]},s))}):0===e.length?a.jsx("div",{className:"text-center py-8 text-muted-foreground",children:eO?"Материалы по выбранным фильтрам не найдены.":"Нет материалов. Добавьте RSS фиды и синхронизируйте их на главной."}):(0,a.jsxs)(i.iA,{children:[a.jsx(i.xD,{children:(0,a.jsxs)(i.SC,{children:[a.jsx(i.ss,{className:"w-12",children:a.jsx(x.X,{checked:e.length>0&&e.every(e=>J.has(e.id)),onCheckedChange:()=>{if(!W?.running){if(J.size===e.length&&e.length>0){let s=new Set(J);e.forEach(e=>s.delete(e.id)),Y(s)}else{let s=new Set(J);e.forEach(e=>s.add(e.id)),Y(s)}}},disabled:!!W?.running})}),a.jsx(i.ss,{className:"w-20",children:"Обложка"}),a.jsx(i.ss,{className:"min-w-[300px]",children:"Заголовок"}),a.jsx(i.ss,{className:"w-[220px]",children:"Категории"}),a.jsx(i.ss,{children:"Источник"}),a.jsx(i.ss,{className:"w-[130px]",children:"Дата"}),a.jsx(i.ss,{className:"w-[140px]",children:"Статус"})]})}),a.jsx(i.RM,{children:W?.running?Array.from({length:Math.min(e.length||ea,ea)}).map((e,s)=>(0,a.jsxs)(i.SC,{children:[a.jsx(i.pj,{children:a.jsx(u.O,{className:"h-4 w-4 rounded"})}),a.jsx(i.pj,{children:a.jsx(u.O,{className:"h-16 w-16 rounded"})}),(0,a.jsxs)(i.pj,{children:[a.jsx(u.O,{className:"h-4 w-48"}),a.jsx(u.O,{className:"mt-2 h-4 w-64"})]}),a.jsx(i.pj,{children:a.jsx(u.O,{className:"h-4 w-40"})}),a.jsx(i.pj,{children:a.jsx(u.O,{className:"h-4 w-28"})}),a.jsx(i.pj,{children:a.jsx(u.O,{className:"h-4 w-24"})}),a.jsx(i.pj,{children:a.jsx(u.O,{className:"h-4 w-24"})})]},`bulk-skeleton-${s}`)):e.map(e=>(0,a.jsxs)(i.SC,{className:"cursor-pointer hover:bg-accent/50",children:[a.jsx(i.pj,{onClick:e=>e.stopPropagation(),children:a.jsx(x.X,{checked:J.has(e.id),onCheckedChange:()=>eJ(e.id),disabled:!!W?.running})}),a.jsx(i.pj,{onClick:()=>!W?.running&&eL(e),children:e.thumbnail?a.jsx("img",{src:e.thumbnail,alt:e.title,className:"w-16 h-16 object-cover rounded",onError:e=>{e.currentTarget.style.display="none"}}):a.jsx("div",{className:"w-16 h-16 bg-muted rounded flex items-center justify-center text-xs text-muted-foreground",children:"Нет фото"})}),a.jsx(i.pj,{className:"font-medium",onClick:()=>!W?.running&&eL(e),children:a.jsx("div",{className:"line-clamp-3 leading-snug",children:e.title})}),a.jsx(i.pj,{onClick:()=>!W?.running&&eL(e),children:e.categories&&e.categories.length>0?(0,a.jsxs)("div",{className:"flex max-w-[220px] flex-wrap gap-1",children:[e.categories.slice(0,3).map(s=>a.jsx(c.C,{variant:"outline",className:"text-xs font-normal",children:s.name},`${e.id}-category-${s.id}`)),e.categories.length>3&&(0,a.jsxs)(c.C,{variant:"secondary",className:"text-xs font-normal",children:["+",e.categories.length-3]})]}):a.jsx("span",{className:"text-xs text-muted-foreground",children:"—"})}),a.jsx(i.pj,{onClick:()=>!W?.running&&eL(e),children:a.jsx("div",{className:"truncate max-w-[200px]",title:e.feedName||e.source,children:e.feedName||e.source||"—"})}),a.jsx(i.pj,{onClick:()=>!W?.running&&eL(e),children:e0(e.createdAt)}),a.jsx(i.pj,{onClick:()=>!W?.running&&eL(e),children:eQ(e.status)})]},e.id))})]}),!t&&e.length>0&&(0,a.jsxs)("div",{className:"flex items-center justify-between mt-4 pt-4 border-t",children:[a.jsx("div",{className:"flex items-center gap-2",children:(0,a.jsxs)("span",{className:"text-sm text-muted-foreground",children:["Показано ",0===e.length?0:eF+1,"-",eU," из ",ei]})}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-sm text-muted-foreground",children:"На странице:"}),a.jsx("div",{className:"flex gap-1",children:[25,50,100,200].map(e=>a.jsx(l.z,{variant:ea===e?"default":"outline",size:"sm",onClick:()=>eH(e),className:"h-8 w-12",children:e},e))})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[a.jsx(l.z,{variant:"outline",size:"sm",onClick:()=>eV(1),disabled:1===es,className:"h-8 w-8 p-0",title:"Первая страница",children:a.jsx(I.Z,{className:"h-4 w-4"})}),a.jsx(l.z,{variant:"outline",size:"sm",onClick:()=>eV(es-1),disabled:1===es,className:"h-8 w-8 p-0",title:"Предыдущая страница",children:a.jsx($.Z,{className:"h-4 w-4"})}),(0,a.jsxs)("div",{className:"flex items-center gap-1 px-2",children:[a.jsx("span",{className:"text-sm font-medium",children:es}),a.jsx("span",{className:"text-sm text-muted-foreground",children:"из"}),a.jsx("span",{className:"text-sm font-medium",children:el})]}),a.jsx(l.z,{variant:"outline",size:"sm",onClick:()=>eV(es+1),disabled:es===el,className:"h-8 w-8 p-0",title:"Следующая страница",children:a.jsx(Z.Z,{className:"h-4 w-4"})}),a.jsx(l.z,{variant:"outline",size:"sm",onClick:()=>eV(el),disabled:es===el,className:"h-8 w-8 p-0",title:"Последняя страница",children:a.jsx(A.Z,{className:"h-4 w-4"})})]})]})]})]})]}),a.jsx(o.aR,{open:null!==B,onOpenChange:e=>!e&&K(null),children:(0,a.jsxs)(o._T,{children:[(0,a.jsxs)(o.fY,{children:[a.jsx(o.f$,{children:e2?.title}),a.jsx(o.yT,{children:e2?.description})]}),(0,a.jsxs)(o.xo,{children:[a.jsx(o.le,{children:"Отмена"}),a.jsx(o.OL,{onClick:eR,disabled:W?.running===!0,className:`${e2?.variant==="destructive"?"bg-destructive text-destructive-foreground hover:bg-destructive/90":""}`,children:e2?.actionText})]})]})}),a.jsx(d.Vq,{open:F,onOpenChange:U,children:(0,a.jsxs)(d.cZ,{className:"w-[min(95vw,1100px)] max-h-[85vh] overflow-y-auto",children:[(0,a.jsxs)(d.fK,{children:[a.jsx(d.$N,{className:"text-2xl pr-8",children:D?.title}),(0,a.jsxs)(d.Be,{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex flex-wrap gap-4 text-sm",children:[(0,a.jsxs)("span",{children:[a.jsx("strong",{children:"Автор:"})," ",D?.author||"—"]}),(0,a.jsxs)("span",{children:[a.jsx("strong",{children:"Источник:"})," ",D?.feedName||D?.source||"—"]}),(0,a.jsxs)("span",{children:[a.jsx("strong",{children:"Дата:"})," ",D&&e0(D.createdAt)]})]}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-2",children:[a.jsx(c.C,{variant:D?.processed?"secondary":"outline",className:D?.processed?"border-green-500/20 bg-green-500/10 text-green-700 dark:text-green-400":"text-muted-foreground",children:D?.processed?"Обработан":"Не обработан"}),a.jsx(c.C,{variant:D?.published?"secondary":"outline",className:D?.published?"border-blue-500/20 bg-blue-500/10 text-blue-700 dark:text-blue-400":"text-muted-foreground",children:D?.published?"Опубликован":"Не опубликован"})]})]})]}),(0,a.jsxs)("div",{className:"mt-6 space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-xs font-semibold uppercase tracking-wide text-muted-foreground",children:"Мета описание"}),(0,a.jsxs)("span",{className:"text-xs text-muted-foreground",children:[ez.length,"/160"]})]}),a.jsx(p.g,{value:ez,onChange:e=>eI(e.target.value),maxLength:160,rows:3,placeholder:"Краткое описание статьи"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-xs font-semibold uppercase tracking-wide text-muted-foreground",children:"Саммари"}),D?.summary&&a.jsx(c.C,{variant:"secondary",children:"AI"})]}),a.jsx(p.g,{value:eC,onChange:e=>eS(e.target.value),rows:6,placeholder:"Краткое саммари на 3-5 предложений"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[a.jsx("div",{className:"flex items-center justify-between",children:a.jsx("span",{className:"text-xs font-semibold uppercase tracking-wide text-muted-foreground",children:"Категории публикации"})}),a.jsx("div",{className:"flex flex-wrap gap-2",children:ew.categoryIds.length>0?ew.categoryIds.map(e=>ed.categories.find(s=>s.id===e)).filter(e=>!!e).map(e=>(0,a.jsxs)(c.C,{variant:e.isHidden?"outline":"secondary",className:"gap-1",children:[e.name,e.isHidden&&a.jsx("span",{className:"ml-1 rounded bg-muted px-1 text-[10px] uppercase text-muted-foreground",children:"скрыта"}),a.jsx(l.z,{type:"button",variant:"ghost",size:"icon",className:"h-4 w-4 text-muted-foreground hover:text-destructive",onClick:()=>eY("categoryIds",e.id),children:a.jsx(q.Z,{className:"h-3 w-3"})})]},`pub-category-${e.id}`)):a.jsx("span",{className:"text-xs text-muted-foreground",children:"У материала нет выбранных категорий"})})]})]}),(0,a.jsxs)("div",{className:"mt-6 space-y-3",children:[a.jsx(l.z,{variant:"outline",size:"sm",onClick:()=>H(e=>!e),className:"w-full sm:w-56",children:V?"Скрыть полный текст":"Показать полный текст"}),V&&a.jsx("div",{className:"rounded-lg border bg-background p-4 text-sm leading-relaxed",children:D?.fullContent?a.jsx("div",{className:"prose prose-sm max-w-none dark:prose-invert",dangerouslySetInnerHTML:{__html:D.fullContent.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,"").replace(/on\w+="[^"]*"/g,"").replace(/on\w+='[^']*'/g,"")}}):a.jsx("p",{className:"text-foreground",children:D?.content})})]}),a.jsx("div",{className:"mt-6 space-y-6",children:em?a.jsx("div",{className:"text-sm text-muted-foreground",children:"Загрузка справочников..."}):(0,a.jsxs)("div",{className:"space-y-5",children:[(0,a.jsxs)("section",{className:"rounded-lg border bg-muted/30 p-4 space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-1",children:[a.jsx(g._,{className:"text-sm font-semibold",children:"Категории"}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Выберите 1–3 наиболее релевантных категории или добавьте новую."})]}),(0,a.jsxs)("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:gap-3",children:[a.jsx(R,{label:"Добавить из списка",options:ed.categories.map(e=>({value:e.id,label:e.isHidden?`${e.name} (скрыта)`:e.name})),selected:ew.categoryIds,onChange:e=>ek(s=>({...s,categoryIds:e})),disabled:0===ed.categories.length,fullWidth:!0,maxSelected:1}),a.jsx(l.z,{variant:"ghost",size:"sm",onClick:()=>eW("categoryIds"),disabled:0===ew.categoryIds.length,className:"sm:w-auto w-full",children:"Очистить"})]}),a.jsx("div",{className:"flex flex-wrap gap-2",children:ew.categoryIds.length>0?ew.categoryIds.map(e=>{let s=ed.categories.find(s=>s.id===e);return s?(0,a.jsxs)(c.C,{variant:"secondary",className:"gap-1",children:[s.name,a.jsx("button",{type:"button",className:"ml-1 inline-flex h-4 w-4 items-center justify-center rounded-sm hover:text-destructive",onClick:()=>eY("categoryIds",e),children:a.jsx(q.Z,{className:"h-3 w-3"})})]},`selected-category-${e}`):null}):a.jsx("span",{className:"text-xs text-muted-foreground",children:"Категории не выбраны"})}),(0,a.jsxs)("div",{className:"space-y-2 border-t pt-4",children:[a.jsx(g._,{className:"text-xs font-medium text-muted-foreground",children:"Нет нужной категории?"}),(0,a.jsxs)("div",{className:"flex flex-col gap-2 sm:flex-row",children:[a.jsx(h.I,{value:eb.category,onChange:eG("category"),placeholder:"Название новой категории",className:"h-9"}),a.jsx(l.z,{size:"sm",onClick:()=>eX("category"),disabled:"category"===ey,children:"category"===ey?"Добавление...":"Добавить"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-5",children:[(0,a.jsxs)("section",{className:"rounded-lg border bg-muted/10 p-4 space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-1",children:[a.jsx(g._,{className:"text-sm font-semibold",children:"Страны"}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Укажите страны, к которым относится материал."})]}),(0,a.jsxs)("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:gap-3",children:[a.jsx(R,{label:"Добавить страну",options:ed.countries.map(e=>({value:e.id,label:e.name})),selected:ew.countryIds,onChange:e=>ek(s=>({...s,countryIds:e})),disabled:0===ed.countries.length,fullWidth:!0}),a.jsx(l.z,{variant:"ghost",size:"sm",onClick:()=>eW("countryIds"),disabled:0===ew.countryIds.length,className:"sm:w-auto w-full",children:"Очистить"})]}),a.jsx("div",{className:"flex flex-wrap gap-2",children:ew.countryIds.length>0?ew.countryIds.map(e=>{let s=ed.countries.find(s=>s.id===e);return s?(0,a.jsxs)(c.C,{variant:"secondary",className:"gap-1",children:[s.name,a.jsx("button",{type:"button",className:"ml-1 inline-flex h-4 w-4 items-center justify-center rounded-sm hover:text-destructive",onClick:()=>eY("countryIds",e),children:a.jsx(q.Z,{className:"h-3 w-3"})})]},`selected-country-${e}`):null}):a.jsx("span",{className:"text-xs text-muted-foreground",children:"Страны не выбраны"})}),(0,a.jsxs)("div",{className:"space-y-2 border-t pt-4",children:[a.jsx(g._,{className:"text-xs font-medium text-muted-foreground",children:"Добавить новую страну"}),(0,a.jsxs)("div",{className:"flex flex-col gap-2 sm:flex-row",children:[a.jsx(h.I,{value:eb.country,onChange:eG("country"),placeholder:"Название новой страны",className:"h-9"}),a.jsx(l.z,{size:"sm",onClick:()=>eX("country"),disabled:"country"===ey,children:"country"===ey?"Добавление...":"Добавить"})]})]})]}),(0,a.jsxs)("section",{className:"rounded-lg border bg-muted/10 p-4 space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-1",children:[a.jsx(g._,{className:"text-sm font-semibold",children:"Города"}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Выберите города. Сначала укажите страну — мы подберём связанные города автоматически."})]}),(0,a.jsxs)("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:gap-3",children:[a.jsx(R,{label:"Добавить город",options:eq,selected:ew.cityIds,onChange:e=>ek(s=>({...s,cityIds:e})),disabled:0===eq.length,fullWidth:!0}),a.jsx(l.z,{variant:"ghost",size:"sm",onClick:()=>eW("cityIds"),disabled:0===ew.cityIds.length,className:"sm:w-auto w-full",children:"Очистить"})]}),a.jsx("div",{className:"flex flex-wrap gap-2",children:ew.cityIds.length>0?ew.cityIds.map(e=>{let s=eq.find(s=>s.value===e);return s?(0,a.jsxs)(c.C,{variant:"secondary",className:"gap-1",children:[s.label,a.jsx("button",{type:"button",className:"ml-1 inline-flex h-4 w-4 items-center justify-center rounded-sm hover:text-destructive",onClick:()=>eY("cityIds",e),children:a.jsx(q.Z,{className:"h-3 w-3"})})]},`selected-city-${e}`):null}):a.jsx("span",{className:"text-xs text-muted-foreground",children:"Города не выбраны"})}),(0,a.jsxs)("div",{className:"space-y-2 border-t pt-4",children:[a.jsx(g._,{className:"text-xs font-medium text-muted-foreground",children:"Добавить новый город"}),(0,a.jsxs)("div",{className:"flex flex-col gap-2 sm:flex-row",children:[a.jsx(h.I,{value:eb.city,onChange:eG("city"),placeholder:"Название нового города",className:"h-9",disabled:0===ew.countryIds.length}),a.jsx(l.z,{size:"sm",onClick:()=>eX("city"),disabled:0===ew.countryIds.length||"city"===ey,children:"city"===ey?"Добавление...":"Добавить"})]}),0===ew.countryIds.length&&a.jsx("p",{className:"text-xs text-muted-foreground",children:"Чтобы добавить город, сначала выберите страну."})]})]})]})]})}),(0,a.jsxs)("div",{className:"mt-6 flex flex-col items-end gap-2",children:[a.jsx(l.z,{onClick:eK,disabled:ef||em,variant:"outline",className:"w-full sm:w-56",children:ef?(0,a.jsxs)(a.Fragment,{children:[a.jsx(C,{className:"mr-2 h-4 w-4 animate-spin"}),"Регенерация..."]}):(0,a.jsxs)(a.Fragment,{children:[a.jsx(C,{className:"mr-2 h-4 w-4"}),"Регенерировать таксономию"]})}),a.jsx(l.z,{onClick:eB,disabled:e$||ep||em,className:"w-full sm:w-56",children:e$||ep?"Сохранение...":"Сохранить"})]}),(D?.link||D?.source)&&a.jsx("div",{className:"mt-6 pt-4 border-t",children:a.jsx(l.z,{variant:"outline",size:"sm",asChild:!0,children:(0,a.jsxs)("a",{href:D.link||D.source||"#",target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2",children:[a.jsx(M.Z,{className:"h-4 w-4"}),"Открыть источник"]})})})]})})]})})]})}},97:(e,s,t)=>{"use strict";t.d(s,{$F:()=>o,AW:()=>m,Ju:()=>h,VD:()=>p,Xi:()=>x,bO:()=>u,h_:()=>d});var a=t(326),r=t(7577),l=t(5432),n=t(6562),i=t(799),c=t(7863);let d=l.fC,o=l.xz;l.ZA,l.Uv,l.Tr,l.Ee,r.forwardRef(({className:e,inset:s,children:t,...r},i)=>(0,a.jsxs)(l.fF,{ref:i,className:(0,c.cn)("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",s&&"pl-8",e),...r,children:[t,a.jsx(n.Z,{className:"ml-auto h-4 w-4"})]})).displayName=l.fF.displayName,r.forwardRef(({className:e,...s},t)=>a.jsx(l.tu,{ref:t,className:(0,c.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...s})).displayName=l.tu.displayName;let m=r.forwardRef(({className:e,sideOffset:s=4,...t},r)=>a.jsx(l.Uv,{children:a.jsx(l.VY,{ref:r,sideOffset:s,className:(0,c.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...t})}));m.displayName=l.VY.displayName;let x=r.forwardRef(({className:e,inset:s,...t},r)=>a.jsx(l.ck,{ref:r,className:(0,c.cn)("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s&&"pl-8",e),...t}));x.displayName=l.ck.displayName;let u=r.forwardRef(({className:e,children:s,checked:t,...r},n)=>(0,a.jsxs)(l.oC,{ref:n,className:(0,c.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),checked:t,...r,children:[a.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:a.jsx(l.wU,{children:a.jsx(i.Z,{className:"h-4 w-4"})})}),s]}));u.displayName=l.oC.displayName,r.forwardRef(({className:e,children:s,...t},r)=>(0,a.jsxs)(l.Rk,{ref:r,className:(0,c.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...t,children:[a.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:a.jsx(l.wU,{children:a.jsx("span",{className:"h-2 w-2 rounded-full bg-current"})})}),s]})).displayName=l.Rk.displayName;let h=r.forwardRef(({className:e,inset:s,...t},r)=>a.jsx(l.__,{ref:r,className:(0,c.cn)("px-2 py-1.5 text-sm font-semibold",s&&"pl-8",e),...t}));h.displayName=l.__.displayName;let p=r.forwardRef(({className:e,...s},t)=>a.jsx(l.Z0,{ref:t,className:(0,c.cn)("-mx-1 my-1 h-px bg-muted",e),...s}));p.displayName=l.Z0.displayName},7673:(e,s,t)=>{"use strict";t.d(s,{g:()=>n});var a=t(326),r=t(7577),l=t(7863);let n=r.forwardRef(({className:e,...s},t)=>a.jsx("textarea",{className:(0,l.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:t,...s}));n.displayName="Textarea"},2227:(e,s,t)=>{"use strict";t.r(s),t.d(s,{$$typeof:()=>n,__esModule:()=>l,default:()=>i});var a=t(8570);let r=(0,a.createProxy)(String.raw`/Users/macbookpro/Desktop/syndicateadmin/app/admin/materials/page.tsx`),{__esModule:l,$$typeof:n}=r;r.default;let i=(0,a.createProxy)(String.raw`/Users/macbookpro/Desktop/syndicateadmin/app/admin/materials/page.tsx#default`)},770:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});let a=(0,t(7926).Z)("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},8120:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});let a=(0,t(7926).Z)("Archive",[["rect",{width:"20",height:"5",x:"2",y:"4",rx:"2",key:"uhwcea"}],["path",{d:"M4 9v9a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9",key:"shkvi4"}],["path",{d:"M10 13h4",key:"ytezjc"}]])},4674:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});let a=(0,t(7926).Z)("CheckCircle2",[["path",{d:"M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10z",key:"14v8dr"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]])},6694:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});let a=(0,t(7926).Z)("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]])},2959:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});let a=(0,t(7926).Z)("ExternalLink",[["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}],["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["line",{x1:"10",x2:"21",y1:"14",y2:"3",key:"18c3s4"}]])}};var s=require("../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),a=s.X(0,[8948,2283,896,434,4915,4025,5594,5432,7392,8103,3464],()=>t(3934));module.exports=a})();