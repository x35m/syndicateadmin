"use strict";(()=>{var e={};e.id=149,e.ids=[149],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},5900:e=>{e.exports=require("pg")},4460:(e,t,s)=>{s.r(t),s.d(t,{originalPathname:()=>b,patchFetch:()=>f,requestAsyncStorage:()=>g,routeModule:()=>d,serverHooks:()=>h,staticGenerationAsyncStorage:()=>m});var a={};s.r(a),s.d(a,{DELETE:()=>c,GET:()=>p,PATCH:()=>l});var r=s(9303),o=s(8716),n=s(670),i=s(7070),u=s(9487);async function p(e){try{let t;let{searchParams:s}=new URL(e.url),a=s.get("status"),r=s.get("page")?parseInt(s.get("page")):void 0,o=s.get("pageSize")?parseInt(s.get("pageSize")):void 0,n=s.get("search")||void 0,p=s.get("categoryIds")?.split(",").map(Number).filter(Boolean),l=s.get("countryIds")?.split(",").map(Number).filter(Boolean),c=s.get("cityIds")?.split(",").map(Number).filter(Boolean),d=s.get("feedNames")?.split(",").filter(Boolean),g="true"===s.get("onlyWithSummary");if(void 0!==r||void 0!==o||n||p||l||c||d||g){let e=await u.db.getMaterialsPaginated({page:r,pageSize:o,status:a||void 0,search:n,categoryIds:p,countryIds:l,cityIds:c,feedNames:d,onlyWithSummary:g}),t=await u.db.getStats();return i.NextResponse.json({success:!0,data:e.materials,pagination:{page:e.page,pageSize:e.pageSize,total:e.total,totalPages:e.totalPages},stats:{total:parseInt(t.total||"0"),new:parseInt(t.new_count||"0"),processed:parseInt(t.processed_count||"0"),published:parseInt(t.published_count||"0"),archived:parseInt(t.archived_count||"0")}})}t=a&&"all"!==a?await u.db.getMaterialsByStatus(a):await u.db.getAllMaterials();let m=await u.db.getStats();return i.NextResponse.json({success:!0,data:t,stats:{total:parseInt(m.total||"0"),new:parseInt(m.new_count||"0"),processed:parseInt(m.processed_count||"0"),published:parseInt(m.published_count||"0"),archived:parseInt(m.archived_count||"0")}})}catch(e){return console.error("API Error:",e),i.NextResponse.json({success:!1,error:"Failed to fetch materials"},{status:500})}}async function l(e){try{let{id:t,status:s,processed:a,published:r}=await e.json();if(!t)return i.NextResponse.json({success:!1,error:"Missing id"},{status:400});let o={};if("string"==typeof s&&s.trim().length>0&&(o.status=s.trim()),"boolean"==typeof a&&(o.processed=a),"boolean"==typeof r&&(o.published=r),0===Object.keys(o).length)return i.NextResponse.json({success:!1,error:"No updates were provided"},{status:400});return await u.db.updateMaterialAttributes(t,o),i.NextResponse.json({success:!0,message:"Material updated successfully"})}catch(e){return console.error("API Error:",e),i.NextResponse.json({success:!1,error:"Failed to update material"},{status:500})}}async function c(e){try{let{searchParams:t}=new URL(e.url),s=t.get("id");if(!s)return i.NextResponse.json({success:!1,error:"Missing material ID"},{status:400});return await u.db.deleteMaterial(s),i.NextResponse.json({success:!0,message:"Material deleted successfully"})}catch(e){return console.error("API Error:",e),i.NextResponse.json({success:!1,error:"Failed to delete material"},{status:500})}}let d=new r.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/materials/route",pathname:"/api/materials",filename:"route",bundlePath:"app/api/materials/route"},resolvedPagePath:"/Users/macbookpro/Desktop/syndicateadmin/app/api/materials/route.ts",nextConfigOutput:"standalone",userland:a}),{requestAsyncStorage:g,staticGenerationAsyncStorage:m,serverHooks:h}=d,b="/api/materials/route";function f(){return(0,n.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:m})}}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[948,972,487],()=>s(4460));module.exports=a})();